<!DOCTYPE html><!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Thu Mar 31 2022 05:48:53 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="6204a14f201eec0102294871" data-wf-site="61fb361452ff0215fe4db1db">
<head>
  <meta charset="utf-8">
  <title>Front</title>
  <meta content="Front" property="og:title">
  <meta content="Front" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../user/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../user/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../user/css/zemeet.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Noto Sans KR:100,300,regular,500,700,900:korean,latin"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../user/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../user/images/webclip.png" rel="apple-touch-icon">
</head>
<body class="body1">
  <div class="frame">
    <div class="common_container">
      <div class="section1">
        <div class="chatblock"><img src="../user/images/zemeet_logo.svg" loading="lazy" alt="" class="logo">
          <div class="chatbord" style="display:none;">
            <div class="chat_top">
              <a href="javascript:closechattingbox()" class="link-block-16 w-inline-block"><img src="../user/images/chevron-left.svg" loading="lazy" alt=""></a>
            </div>
            <!-- 1대1 채팅방 대화창 -->
            <div class="chattingbox" style="display:none;" id = "chattingbox">
              <!-- <div class="chatting_scroll">
                <div class="chatting _1">
                  <div class="chatbox _1">
                    <div>안녕하세요.</div>
                  </div>
                  <div class="chattime">오전 01:01</div>
                </div>
                <div class="chatting">
                  <div class="chatting_from">1번방</div>
                  <div class="chatbox _2">
                    <div>안녕하세요.</div>
                  </div>
                  <div class="chattime">오전 01:01</div>
                </div>
              </div> -->
            </div>
            <!-- 1대1 채팅방 대화창 -->
            <!-- 매크로용 채팅 메세지 목록 -->
            <div class="macrolist_warp" style="display:none;">
              <div class="macro_slider" style="display:none;">
                <a href="#" class="link-block-21 w-inline-block">
                </a>
              </div>
              <a href="javascript:macroopen()" class="macrolistbtn w-inline-block">
                <div class="text-block-17">매크로</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="image-38">
              </a>
            </div>
            <!-- 매크로용 채팅 메세지 목록 -->
          </div>
          <!-- 전체 채팅방 리스트 -->
          <div class="chatbord chattingroom" style="display:flex;" id="chattingroomboard">
            <div class="chattingroom">
              <div class="chatroom_warp">
                <!-- <a href="javascript:chatDetail('3')" class="link-block-17 listtop w-inline-block">
                  <div class="chatroom_num">3번방</div>
                  <div class="chatroom_intext">내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용내용</div>
                  <div class="chatboom_time">5분전</div>
                  <div class="newchat">N</div>
                </a>  -->
              </div>
            </div>
          </div>
          <!-- 전체 채팅방 리스트 -->
          <!-- 채팅 입력 창 -->
          <div class="chattingbar" style="display:none;">
            <div class="form-block w-form">
              <input type="text" class="text-field w-input" name="chat" placeholder="채팅 내용을 입력해주세요" id="chat" >
            </div>
            <a href="javascript:chatSend()" id="chatSendBtn" class="button w-button">Send</a>
          </div>
          <!-- 채팅 입력 창 -->

          <!-- <div class="chatm_scroll"></div> -->
        </div>
      </div>
      <div class="section4">
        <div class="top">
          <div class="front_top">
            <div class="front_togglewarp">
              <a href="#" class="front_top-alarm w-inline-block"><img src="../user/images/bell.svg" loading="lazy" alt="">
                <div class="front_alarmcircle">
                  <div id="alarmcount_">0</div>
                </div>
              </a>
              <div class="front_togglebox" style="display: none;" id = "alarm">
                <div class="alarm_box" id="onlyalarm">
                </div>
              </div>
            </div>
            <div class="front_togglewarp">
              <a href="#" class="front_topbtn w-button">대기열</a>
              <div class="front_alarmcircle">
                <div>99</div>
              </div>
              <div class="front_togglebox wait" style="display: none;" id = "wait">
                <div class="alarm_box">
                  <div class="alarm_warp">
                    <div>대기순번: 155번</div>
                    <a href="#" class="button-18 w-button">알림보내기</a>
                  </div>
                  <div class="alarm_warp">
                    <div>대기순번: 155번</div>
                    <a href="#" class="button-18 w-button">알림보내기</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="front_topwarp">
              <a href="javascript:getReservation()" class="button-17 _2 w-button">예약 현황</a>
              <a href="javascript:openPop('pop_calculate')" class="front_topbtn w-button">오늘의 정산</a>
              <div class="time_front">
                <div class = "currentTime"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="front_block">
          <div class="front_roomblock">

            <!-- (빈방 : 0 (class : ) / 사용중 : 1 (class : on ) / n분 후 예약된 방 : 2 (class : reserved)) -->
            <!-- <div class="frontroom_warp">
              <div id="w-node-_6e0e4cff-177d-8746-67fa-33b8149c6896-02294871" class="roombox"  onclick ="dependOnStatus(this,0)">
                <div class="roon_numtxt">2</div>
                <div class="starttime"><span class="timetitle">사용시작</span>00:00</div>
                <div><span class="timetitle">사용시간</span>00:00</div>
                <div class="endtime"><span class="timetitle">남은시간</span>00:00</div>
                <div class="memo_prv">사용 중 X</div>
              </div>
            </div> -->
          </div>
        </div>
      </div>
      <div class="div-block-24">
        <a href="javascript:openPop('pop_todo')" class="button-17 w-button">To Do List</a>
      </div>
    </div>
    <div class="popup" style="display:none;">
      <div class="todopop" style="display:none;" id = "pop_todo">
        <div class="todo_innerpop" style="display:none;" id = "pop_inner">
          <div class="todo_confirmpop"  id = "pop_confirm">
            <a href="javascript:closeInnerPop('pop_inner')" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
            <div class="poptitle">업무 완료 확인</div>
            <div class="todo_confirmbox">
              <div class="div-block-43">
                <div id="number4">**** 번</div>
                <div class="form-block-14 w-form">
                  <form id="staffForm">
                    <select id="staff_name" name="staff_idx" class="select-field-6 w-select">
                    </select>
                  </form>
                </div>
                <div>직원 업무 완료처리 하시겠습니까?</div>
              </div>
            </div>
            <a href="javascript:todocomplete_last()" class="button-30 w-button">확인</a>
          </div>
        </div>
        <form id="todolistForm" name="email-form-2" data-name="Email Form 2">
          <div class="todo_box">
            <div class="poptitle">TO DO LIST</div>
            <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
            <div class="pop_box2">
              <div class="form-block-6 w-form">
                  <div class="todo_title">수행목록</div>
                  <div class="todo_section">
                    <div class="todo_scroll" id="todo_list">
                      <!-- <label class="w-checkbox checkbox-field"><input type="checkbox" id="checkbox-2" name="checkbox-2" data-name="Checkbox 2" class="w-checkbox-input"><span class="checkbox-label w-form-label" for="checkbox-2"></span></label> -->
                    </div>
                  </div>
                  <div class="todo_title">완료목록</div>
                  <div class="todo_section">
                    <div class="todo_scroll" id="todo_endlist">
                      <!-- <label class="w-checkbox checkbox-field"><input type="checkbox" id="checkbox-2" name="checkbox-2" data-name="Checkbox 2" class="w-checkbox-input"><span class="checkbox-label w-form-label" for="checkbox-2">할 일</span></label> -->
                    </div>
                  </div>
              </div>
            </div>
            <div class="form-block-7 w-form">
              <label for="email" style="text-align:left;">업무 완료 처리</label>
                <div class="todo_warp"><input type="email" class="text-field-4 w-input" maxlength="4" name="todonumber"  placeholder="전화번호 뒤 4자리를 입력해주세요." id="todonumber" required="">
                  <a href="javascript:todocomplete()" class="button-12 w-button">업무 완료</a>
                </div>
            </div>
          </div>
        </form>
      </div>
      <div class="paymentpop" style="display:none;" id = "pop_payment">
        <div class="payment_popbox">
          <div class="paymentpop_contain"></div>
          <div class="div-block-31">
            <a href="#" class="button-21 w-button">현금</a>
            <a href="#" class="button-21 w-button">카드</a>
          </div>
          <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
        </div>
      </div>
      <div class="front_reservepop" style="display:none;" id = "pop_reserve">
        <div class="front_reservebox">
          <div class="poptitle" id="reservationlist">예약 현황</div>
          <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <!-- 예약현황 -->
          <div class="front_reservelist" id = "reser_Info">
            <!-- <div class="front_listbox1">
              <div id = "reser_detail"></div>
              <div class="text-block-13" id = "reser_use"></div>
              <input type="hidden" name="idx">
              <button type="button" class="button-22-copy w-button">예약취소</button>
            </div> -->
          </div>
          <!-- 예약현황 -->
        </div>
      </div>
      <div class="front_foodpop"  style="display:none;">
        <div class="front_foodpopbox">
          <div class="poptitle" id="foodlist">2번 방: 음식 주문 내역</div>
          <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="front_foodpoplist">
            <div class="food_additional_title">내역</div>
            <div class="div-block-53">
              <!-- <div class="food_list">라면 <span>2개(10000원)</span></div>
              <div class="food_list">라면 <span>2개(10000원)</span></div> -->
            </div>
            <div class="food_additional">
              <div class="food_additional_title">추가 사항</div>
              <div id="additiontext"></div>
            </div>
            <div class="price">총: 100000 원</div>
          </div>
          <div class="btnarea1">
            <a href="javascript:closePop()" class="okbtn w-button">확인</a>
          </div>
        </div>
      </div>
      <div class="front_receiptpop" style="display:none;" id = "pop_receipt">
        <div class="front_receiptbox">
          <div class="poptitle" id = "front_receipt"> 1번 방: 상세 결재 내역</div>
          <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="front_receiptwarp">
            <div class="receipt">
              <div class="receipt_timewarp">
                <div class="receipt_time" id="start_time">시작시간 - 18:00</div>
                <div class="receipt_time" id="use_time">사용시간- 02:00</div>
                <div class="receipt_time" id="left_time">남은시간- 00:30</div>
              </div>
              <div class="receipttitle">주문 내역</div>
              <span id="orderdetail_front">
              </span>
              <div class="receipttitle">총 결제 금액 </div>
              <div class="receipttext">
                <div>선결제(방결제)</div>
                <div id="presell">0원</div>
              </div>
              <div class="receipttext">
                <div>후불결제</div>
                <div id="nextsell">5,000원</div>
              </div>
              <div class="receipttext result">
                <div>합계</div>
                <div id="allsell">5,000원</div>
              </div>
            </div>
          </div>
          <div class="btnarea2">
            <a href="#" class="button-31 w-button" onclick="calculate('1')">카드</a>
            <a href="#" class="button-31 w-button" onclick="calculate('2')">현금</a>
          </div>
        </div>
      </div>
      <div class="front_startpop" style="display:none;" id = "pop_start">
        <div class="front_startpopbox">
          <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">알림</div>
          <div class="nomalpop_warp">
            <div>1번방 사용을 시작하시겠습니까?</div>
          </div>
          <div class="btnarea2">
            <a href="#" class="button-31 w-button">사용시작</a>
          </div>
        </div>
      </div>
      <div class="front_calculatepop" style="display:none;" id = "pop_calculate">
        <div class="calculate_popbox">
          <div class="poptitle">오늘의 정산</div>
          <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="pop_box3">
            <div class="calculate_title">금일 음식 누적액</div>
            <div class="calculate_section">
              <div>1,000,000원</div>
            </div>
            <div class="calculate_title">금일 방 누적액</div>
            <div class="calculate_section">
              <div>1,000,000원</div>
            </div>
            <div class="calculate_title">금일 총 누적액</div>
            <div class="calculate_section result">
              <div>1,000,000원</div>
            </div>
          </div>
        </div>
      </div>
      <div class="food_canclepop" id="calsuccess" style="display:none;">
        <div class="nomalpop_box">
          <div class="poptitle">알림</div>
          <div class="nomalpop_warp">
            <div>결제가 완료되었습니다.</div>
          </div>
          <div class="btnarea2">
            <a href="#" class="button-31 w-button" onclick="closePop()">확인</a>
          </div>
        </div>
      </div>
      <div class="food_canclepop" id="commonalarmpop" style="display:none; position:absolute;">
        <div class="nomalpop_box">
          <div class="poptitle">알림</div>
          <div class="nomalpop_warp" id="alarmment">
            <div>결제가 완료되었습니다.</div>
          </div>
          <div class="btnarea2">
            <a href="#" class="button-31 w-button" onclick="closeInnerPop('commonalarmpop')">확인</a>
          </div>
        </div>
      </div>
      <div class="food_canclepop" id="commonpay" style="display:none; position:absolute; z-index: 100000;">
        <div class="nomalpop_box">
          <div class="poptitle">알림</div>
          <div class="nomalpop_warp" id="commonment">
            <div>결제가 완료되었습니다.</div>
          </div>
          <div class="btnarea2">
            <a href="#" class="button-31 w-button" onclick="closeInnerPop('commonpay','end')">확인</a>
          </div>
        </div>
      </div>
      <div class="totalpayment_pop2" style="display:none;">
        <div class="totalpayment_box2">
          <a href="javascript:commonpay('결제가 완료되었습니다.','end')" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">적립 정보 입력</div>
          <div class="totalpayment_warp2">
            <div>포인트 적립을 위해 적립할 전화번호를 입력해주세요.</div>
            <div class="form-block-15 w-form">
              <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="get">
                <div class="totalpayment_textarea"><input type="text" class="text-field-9 w-input" maxlength="11" name="field-3" placeholder="전화번호를 입력해주세요." id="point_number" required=""></div>
              </form>
            </div>
            <div class="div-block-50">
              <div class="telephone_grid">
                <a id="w-node-_0d5d74f5-55e2-5d4c-5502-60dcc1e5e3d0-9edf0637" href="javascript:pointNum(1)" class="telephne_btn w-inline-block">
                  <div>1</div>
                </a>
                <a id="w-node-aec9ed9b-7079-1a2a-7789-0b4683f04f13-9edf0637" href="javascript:pointNum(2)" class="telephne_btn w-inline-block">
                  <div>2</div>
                </a>
                <a id="w-node-f386cdc9-37a8-f55b-135c-59a8722e4b79-9edf0637" href="javascript:pointNum(3)" class="telephne_btn w-inline-block">
                  <div>3</div>
                </a>
                <a id="w-node-c4018bb8-26de-dabd-1a64-db34eddaa405-9edf0637" href="javascript:pointNum(4)" class="telephne_btn w-inline-block">
                  <div>4</div>
                </a>
                <a id="w-node-_7378ffba-59c9-8e08-6bdf-9864ac2e4cf4-9edf0637" href="javascript:pointNum(5)" class="telephne_btn w-inline-block">
                  <div>5</div>
                </a>
                <a id="w-node-_1051b182-1f24-05c1-9bbf-c01be33c10c8-9edf0637" href="javascript:pointNum(6)" class="telephne_btn w-inline-block">
                  <div>6</div>
                </a>
                <a id="w-node-_3d6b143c-586e-5962-109e-bad1ef3e20ab-9edf0637" href="javascript:pointNum(7)" class="telephne_btn w-inline-block">
                  <div>7</div>
                </a>
                <a id="w-node-ee22ed87-1a19-dd3e-e2fe-5c81ad757d4d-9edf0637" href="javascript:pointNum(8)" class="telephne_btn w-inline-block">
                  <div>8</div>
                </a>
                <a id="w-node-_2926f3c5-5fb7-7caf-130e-7d224aa7ffd1-9edf0637" href="javascript:pointNum(9)" class="telephne_btn w-inline-block">
                  <div>9</div>
                </a>
                <a id="w-node-fcae5b66-f626-b92c-d9f0-5b5b2a732ff4-9edf0637" href="javascript:pointNum(-1)" class="telephne_btn _2 w-inline-block">
                  <div>지움</div>
                </a>
                <a id="w-node-a109d601-9088-3178-2c64-667ef582073e-9edf0637" href="javascript:pointNum(0)" class="telephne_btn w-inline-block">
                  <div>0</div>
                </a>
                  <a href="javascript:savePoint()" class="telephne_btn _3 w-inline-block" style="margin-left:16px;">
                  <div>확인</div>
                </a>
              </div>
              <div class="totalpayment_section">
                <div class="title">총 결제금액</div>
                <div class="div-block-52">
                  <div class="totalprice_txt2">후불<span class="pricespan2" id="point_NextPrice">0원</span></div>
                </div>
                <div class="div-block-51">
                  <div class="totalprice_txt">총 합계 <span class="pricespan" id="point_TotalPrice">8,000원</span></div>
                </div>
                <div class="accumulate_area_f">
                  <div class="totalprice_txt3">적립액</div>
                  <div class="accumulate_txtbox_f" id="all_point">0</div>
                </div>
              </div>
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:commonpay('결제가 완료되었습니다.','end')" class="button-32 _2 w-button">취소</a>
          </div>
        </div>
      </div>
      <div class="kioskpop" style="display:none; z-index: 100000;" >
        <div class="kiosk_popbox _pop1">
          <div class="poptitle">알림</div>
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="pop_box">
            <div>적립 하시겠습니까?</div>
            <div class="pop_warntxt">적립 시 주의문구</div>
          </div>
          <div class="btnwarp">
            <a href="javascript:pointpop()" class="kioskpop_btn w-button">확인</a>
            <a href="javascript:commonpay('결제 되었습니다.')" class="kioskpop_btn _2 w-button" >취소</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=61fb361452ff0215fe4db1db" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../user/js/webflow.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
  <style>
    .front_roomblock::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;}
    .front_roomblock::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;}
    .chatting_scroll::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;}
    .chatting_scroll::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;}
    .pop_box2::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;}
    .pop_box2::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;}
    .front_reservelist::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .front_reservelist::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    .alarm_box::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .alarm_box::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    .chattingroom::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .chattingroom::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    .chatmacro::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .chatmacro::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    .todo_scroll::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .todo_scroll::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    .front_receiptwarp::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .front_receiptwarp::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    .macro_slider::-webkit-scrollbar {
    width: 4px;
    height:4px;
    !important;
    }
    .macro_slider::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    !important;
    }
    </style>
</body>
</html>
<script src="../js/currentTime.js" type="text/javascript"></script>
<script src="../js/socket.js" type="text/javascript"></script>
<script>
  // ---------------채팅
  let count=0;
  function chatSend(roomNum,content='1'){
    if(content != '1'){
      var chat = content
    }
    else{
      chat = $("#chat").val();
    }
    console.log("chat",chat)
    let time = new Date()
    if(chat.length == 0){
      return;
    }     
    let str = '';    
    str += '<div class="chatting _1">';
    str += '<div class="chatbox _1">';
    str += '<div style = "word-break:break-all">'+chat+'</div></div>';
    str += '<div class="chattime">'+dateTimeFormat(time)+'</div></div>';
    $("#chatDetail_"+roomNum).append(str);
    $("#chat").val('');
    $("#chatList_"+roomNum).find('.chatroom_intext').text(chat.substring(0,34));
    let obj = new Object();
    obj.protocol = "chat";
    obj.roomNum = roomNum;
    obj.chat = chat;
    obj.time = time;
    doSend(JSON.stringify(obj));
  }
  function macro(content){
    var roomnum_chat;
    console.log("d;dldl",$(".chattingbox").find('.chatting_scroll').length)
    for(i=0; i<$(".chattingbox").find('.chatting_scroll').length; i++){
      if($(".chattingbox").find('.chatting_scroll:eq('+i+')').is(":visible")){
        roomnum_chat = $(".chattingbox").find('.chatting_scroll:eq('+i+')').attr("id").split('_')[1]
      }
    }
    chatSend(roomnum_chat,content)
    $(".macro_slider").css("display","none")

  }
  function roomendwait(idx,roomNm){
    let obj = new Object();
    obj.protocol = "roomEndwait";
    obj.idx = idx;
    obj.roomNm= roomNm;
    doSend(JSON.stringify(obj));
  }
  function roomendcustomer(idx,roomNm){
    let obj = new Object();
    obj.protocol = "roomEndcustomer";
    obj.idx = idx;
    obj.roomNm= roomNm;
    doSend(JSON.stringify(obj));
  }
  function customertime(sobj){//room idx
    let obj = new Object();
    console.log("obj",obj)
    obj.protocol = "customertime";
    obj.idx = sobj.ridx;
    obj.roomNm =sobj.roomNm 
    doSend(JSON.stringify(obj));
  }
 
  function onMessage(evt) { //받은 메세지를 보여준다      
      var obj = JSON.parse(evt.data);            
      console.log(obj);
      if(obj.protocol == "chat"){                        
        if($("#chatList_"+obj.roomNum).length == 0){
          // 채팅방리스트
          let str = '';
          str += '<a href="javascript:chatDetail('+obj.roomNum+')" id="chatList_'+obj.roomNum+'" class="link-block-17 listtop w-inline-block">';
          str += '<div class="chatroom_num">'+obj.roomNum+'번방</div>';
          str += '<div class="chatroom_intext" >'+obj.chat.substring(0,34)+'</div>';
          str += '<div class="chatboom_time">'+dateTimeOfficialFormat(obj.time)+'</div>';
          str += '<div class="newchat">N</div></a>';
          $(".chatroom_warp").prepend(str);
        }else{
          $("#chatList_"+obj.roomNum).find('.chatroom_intext').text(obj.chat.substring(0,34));
          $("#chatList_"+obj.roomNum).append('<div class="newchat">N</div></a>');
          $("#chatList_"+obj.roomNum).append('<div class="chatboom_time">'+dateTimeOfficialFormat(obj.time)+'</div></a>');
        }
        // 채팅방 디테일 
        str = '';
        if($("#chatDetail_"+obj.roomNum).length == 0){
          str += '<div class="chatting_scroll" style="display:none;" id="chatDetail_'+obj.roomNum+'">';
          str += '<div class="chatting">';
          str += '<div class="chatting_from">'+obj.roomNum+'번방</div>';
          str += '<div class="chatbox _2">';
          str += '<div style = "word-break:break-all">'+obj.chat+'</div></div>';
          str += '<div class="chattime">'+dateTimeOfficialFormat(obj.time)+'</div></div></div>';          
          $(".chattingbox").append(str);
        }else{
          str += '<div class="chatting">';
          str += '<div class="chatting_from">'+obj.roomNum+'번방</div>';
          str += '<div class="chatbox _2">';
          str += '<div style = "word-break:break-all">'+obj.chat+'</div></div>';
          str += '<div class="chattime">'+dateTimeOfficialFormat(obj.time)+'</div></div>';    
          $("#chatDetail_"+obj.roomNum).append(str);
        }
      }
      if(obj.protocol == "order"){
        countPlus('alarmcount_')
        console.log("order 프로토콜 들어옴 : " + obj);
        if($("#orderList"+obj.roomNum).length == 0){
          // 음식리스트
          let str = '';
          str += '<div class="alarm_warp food"> ';
          str += '<div onclick="getOrderDetail(\''+obj.roomNum+'\',\''+obj.menuNum+'\')" style="cursor:pointer">'+obj.roomNum+'번 방 음식 주문</div>';
          str += '<a href="#" id="orderList_'+obj.roomNum+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
        }else{s
          $("#chatList_"+obj.roomNum).find('.chatroom_intext').text(obj.chat.substring(0,34));
        }
      }    
      if(obj.protocol == "roomStatus"){ // 방 사용 시작 알림
        console.log("obj",obj)
        customertime(obj)
        countPlus('alarmcount_')
        console.log("roomStatus 프로토콜 들어옴 : " + obj);
          let str = '';
          str += '<div class="alarm_warp "> ';
          str += '<div style="cursor:pointer">'+obj.roomNm+'번 방 사용 시작</div>';
          str += '<a href="#" id="roomList_'+obj.roomNm+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
          // 방 사용 현황 변경 (추가 요함)
          $("#front_roombox_"+obj.ridx).attr('class','roombox on ');
          $("#memoPrv_"+obj.ridx).html('결제 예정');
          $("#front_roombox_"+obj.ridx).attr("onclick","dependOnStatus(this,1,"+obj.ridx+")")
          timecalculate(obj.ridx)
      }    
      if(obj.protocol == "roomStatus_reser"){ // 방 사용 시작 알림(예약자)
        console.log("frontobj",obj)
        customertime(obj)
        countPlus('alarmcount_')
        console.log("roomStatus_reser 프로토콜 들어옴 : " + obj);
          let str = '';
          str += '<div class="alarm_warp "> ';
          str += '<div style="cursor:pointer">'+obj.roomNm+'번 방 사용 시작</div>';
          str += '<a href="#" id="roomList_'+obj.roomNm+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
          // 방 사용 현황 변경 (추가 요함)
          $("#front_roombox_"+obj.ridx).attr('class','roombox on ');
          $("#memoPrv_"+obj.ridx).html('결제 예정');
          $("#front_roombox_"+obj.ridx).attr("onclick","dependOnStatus(this,1,"+obj.ridx+")")
          timecalculate(obj.ridx)
      }    
      if(obj.protocol =="checkadd"){
        console.log("obj",obj)
        countPlus('alarmcount_')
        console.log("roomStatus 프로토콜 들어옴 : " + obj);
          let str = '';
          str += '<div class="alarm_warp add"> ';
          str += '<div style="cursor:pointer">'+obj.roomNm+'번 방 추가 시간 : '+obj.time+'분</div>';
          str += '<a href="#" id="roomList_'+obj.roomNm+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
        reservationlisting()
      }
      if(obj.protocol == "frontstaffcall"){
        console.log("obj,",obj)
        countPlus('alarmcount_')
        let str = '';
          str += '<div class="alarm_warp" style="color:red;"> ';
          str += '<div style="cursor:pointer color:red;">'+obj.roomNm+'번 방 직원 호출</div>';
          str += '<a href="#" id="roomList_'+obj.roomNm+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
      }
      if(obj.protocol =="frontexit5"){
        console.log("obj.",obj)
        countPlus('alarmcount_')
        let str = '';
          str += '<div class="alarm_warp"> ';
          str += '<div style="cursor:pointer">'+obj.roomNm+'번 방 사용 종료 5분 전</div>';
          str += '<a href="#" id="roomList_'+obj.roomNm+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
      }
      if(obj.protocol == "frontexitend"){
        console.log("obj.",obj)
        countPlus('alarmcount_')
        let str = '';
          str += '<div class="alarm_warp"> ';
          str += '<div style="cursor:pointer">'+obj.roomNm+'번 방 사용 종료</div>';
          str += '<a href="#" id="roomList_'+obj.roomNm+'" class="link-block-22 w-inline-block" onclick="closealarmPop(this)"><img src="../user/images/Icon-material-close.svg" loading="lazy" alt="" class="image-39"></a>';
          str += '</div>';
          $("#onlyalarm").prepend(str);
      }
      if(obj.protocol == "cancelalarm"){
        reservationlisting();
        roomendwait()

      }
  }
  //-----------------------------------------
  var r_idx =0;
  var r_roomNm=0;
  function chatDetail(num){
    $(".chatbord").css("display","flex");
    $(".chattingbox").css("display","flex");
    $("#chatDetail_"+num).css("display",'block');
    $(".macrolist_warp").css("display","flex")
    $(".macro_slider").css("display","none")
    $(".chattingbar").css("display","flex");
    $("#chattingroomboard").css("display","none");
    $("#chatSendBtn").attr("href" , "javascript:chatSend("+num+")")
    $("#chat").attr("onkeypress" , "if(event.keyCode == 13) { javascript:chatSend("+num+"); return false;}")
    $("#chatList_"+num).find(".newchat").remove();
  }
  // ---------------------------------- 방 리스팅
  $(document).ready(function(){
    // reservationlisting
    listRoom()
  })
  function listRoom(){
      console.log("hello!")
      $.ajax({
        type : 'get' , 
        url : '/front/getRoom' ,
      }).done(function(data){
        let str ='';
        if(data.result == 'success'){
          for(i=0; i<data.msg.length; i++){
            str += '<div class="frontroom_warp">';
            str += '<div id="front_roombox_'+data.msg[i].idx+'" style = "cursor:default;" class="roombox on"  onclick ="dependOnStatus(this,'+data.msg[i].status+','+data.msg[i].idx+')">';
            str += '<div class="roon_numtxt">'+data.msg[i].roomNm+'</div>';
            str += '<div class="starttime" id = "startTime_'+data.msg[i].idx+'"></div>';
            str += '<div id = "useTime_'+data.msg[i].idx+'"></div>';
            str += '<div class="endtime end" id = "endTime_'+data.msg[i].idx+'"></div>';
            str += '<div class="memo_prv" id = "memoPrv_'+data.msg[i].idx+'"></div>';
            str += '</div>';
            str += '</div>';
          }
        } else {
          str += '<div style = "text-align:center; width:100%;display:flex;align-items: center;">';
          str += '<div style = "width:100%;">이용가능한 방이 없습니다.</div></div>';
        }
        $(".front_roomblock").html(str);
        for(var i = 0; i<data.msg.length; i++){
          if(data.msg[i].status == '1') { // 현재 사용 중인 방 ridx에 해당하는 경우
            $("#front_roombox_"+data.msg[i].idx).attr('class','roombox on ');
            timecalculate(data.msg[i].idx)

          } else if(data.msg[i].status == '2') { // 30분 이내로 예약 시간인 방 ridx에 해당하는 경우
            $("#front_roombox_"+data.msg[i].idx).attr('class','roombox reservation ');
            $("#memoPrv_"+data.msg[i].idx).html('예약');
          } else { 
            $("#front_roombox_"+data.msg[i].idx).attr('class','roombox ');
            $("#memoPrv_"+data.msg[i].idx).html('빈 방');
          }
        }
        }).fail(function(e){
          console.log(JSON.stringify(e));
      })
  }
  
  function timecalculate(idx){
    $.ajax({
        type : 'get' , 
        url : '/timeCalculate?idx='+idx ,
      }).done(function(data){
        let str ='';
        if(data.result == 'success'){
          $("#startTime_"+idx).html('<span class="timetitle">사용시작</span>'+dateTimeFormat(data.log[0].stime));
          $("#useTime_"+idx).html('<span class="timetitle">사용시간</span></div>'+(data.log[0].duration+data.log[0].duration_add)+'분');
          $("#endTime_"+idx).html('<span class="timetitle">남은시간</span>'+savetimeformat(data.log[0].stime,data.log[0].duration,data.log[0].duration_add));
          $("#memoPrv_"+idx).html('결제 예정');
          if(savetimeformat(data.log[0].stime,data.log[0].duration,data.log[0].duration_add).slice(0,1)=='-'){
            $("#endTime_"+idx).html('<span class="timetitle">남은시간</span>0:00');
          }
          else{
            $("#endTime_"+idx).html('<span class="timetitle">남은시간</span>'+savetimeformat(data.log[0].stime,data.log[0].duration,data.log[0].duration_add));
          }
        } 
      }).fail(function(e){
          console.log(JSON.stringify(e));
      })
  }
  function reservationlisting(){
    console.log("예약 체크")
    $.ajax({
    type : 'get' , 
    url : '/RoomList' , //room idx
    }).done(function(data){
        listRoom()
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  init()
  function init(){
    setInterval(minutecheck,1000)
  }
  function minutecheck() {
      let today = new Date()
      let date = new Date(today);
      let month = date.getMonth() + 1;
      let day = date.getDate();
      let hour = date.getHours();
      let minute = date.getMinutes();
      let second = date.getSeconds();
      month = month >= 10 ? month : '0' + month;
      day = day >= 10 ? day : '0' + day;
      hour = hour >= 10 ? hour : '0' + hour;
      minute = minute >= 10 ? minute : '0' + minute;
      second = second >= 10 ? second : '0' + second;

      console.log(date.getFullYear() + '-' + month + '-' + day + ' ' + hour + ':' + minute +':'+second)
      console.log(second)
      if(second == '00'){
        reservationlisting()
      }
    }
  // --------------------------------- 방 리스팅
  function countPlus(id){
    count+=1;
    $("#"+id).html(count)
  }
  function countMinus(id){
    count-=1;
    $("#"+id).html(count)
  }
  function getOrderDetail(roomnum,menunum){
    //doSend(requestOrder())
    $.ajax({
      type : 'get' , 
      url : '/getOrderDetail?menunum='+menunum , 
    }).done(function(data){
      console.log("menulist:",data.menulist); // 여기에 해당 주문이 옴
      let sumprice=0;
      let str='';
      $("#foodlist").html(roomnum+"번 방: 음식 주문 내역")
      for(let i=0; i<data.menulist.length;i++){
        let price = data.menulist[i].price
        str+='<div class="food_list">'+data.menulist[i].name+' <span>'+data.menulist[i].amount+'개('+price*data.menulist[i].amount+'원)</span></div>'
        sumprice+=(data.menulist[i].price)*(data.menulist[i].amount)
      }
      $(".div-block-53").append(str);
      $("#additiontext").html(data.menulist[data.menulist.length-1].request)
      $(".price").html("총: "+sumprice.toLocaleString()+"원")
      $(".front_foodpop").css("display","flex");
      $(".popup").css("display","flex");
      console.log("몇개",$(".div-block-53").find(".food_list").html())
      //===================================방 클릭시 상세 주문내역에 음식 등록
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  function getRoomStatus(){ //방 현황 데이터 수신 / 표시
    //doSend(requestOrder())
    $.ajax({
      type : 'get' , 
      url : '/getRoomStatus', 
    }).done(function(data){
      console.log("roomstatus:",data.roomStatus);

    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  // 채팅---------------
  function dependOnStatus(self, kind, Oidx){ //방 선택시 select class 부여 기존 class 삭제 & 방 현황에 따른 팝업 연결
    $(".roombox").removeClass('select');
    $.ajax({
      type : 'get' , 
      url : '/orderdetail_front?idx='+Oidx,
    }).done(function(data){
      r_idx = data.msg.idx
      r_roomNm = data.msg.roomNm
      console.log("r_idx",r_idx)
      console.log("r_roomNm",r_roomNm)
      let roomNm = data.msg.roomNm
      // 영수증 팝업 오프
      $(self).addClass('select');
      if(kind == 1){
        $("#front_receipt").html(data.msg.roomNm+"번 방: 상세 결제 내역")
        $("#start_time").html('시작시간 - '+dateTimeFormat(data.room[0].stime))
        $("#use_time").html('사용시간 - '+(data.room[0].duration+data.room[0].duration_add)+'분')
        $("#left_time").html('남은시간 - '+savetimeformat(data.room[0].stime,data.room[0].duration,data.room[0].duration_add))
        let str2=''
        if(data.room[0].duration_add !=0){
        console.log(" 들어왔니?")
        str2+='<div class="receipttext" id="roomdetail_front">'
        str2+='<div id="time_room">'+data.room[0].duration_add+'분 추가</div>'
        str2+='<span id="people_room">'+data.room[0].people+'명 (<span id="price_room">'+data.room[0].apay.toLocaleString()+"원)"+'</span></span>'
        str2+='</div>'
        }
        $("#orderdetail_front").prepend(str2);
        let str=''
        let sumprice=0;
        for(let i=0; i<data.list.length; i++){  //주문내역에 각 방의 주문 내역 연결
          if($("#orderdetail_front_"+data.list[i].midx).length > 0){ // 상세결제내역에 똑같은 메뉴가 있을 때
            let foodQuantity = $("#orderdetail_front_"+data.list[i].midx).find("#amount_"); 
            let foodsum = Number(foodQuantity.html().split('개')[0]);
            let AllQuantity = foodsum+Number(data.list[i].amount)
            let allprice = AllQuantity * data.list[i].price
            foodQuantity.html(AllQuantity+"개 (<span id='price_menu'>"+allprice.toLocaleString()+"원)"+'</span></span>') 
          }
          else{ // 똑같은 메뉴가 없을 때
            let price = data.list[i].price * data.list[i].amount
            str+='<div class="receipttext" id="orderdetail_front_'+data.list[i].midx+'">'
            str+='<div id="name_">'+data.list[i].name+'</div>'
            str+='<span id="amount_">'+data.list[i].amount+'개 (<span id="price_menu">'+price.toLocaleString()+"원)"+'</span></span>'
            str+='</div>'
          }
          $("#orderdetail_front").append(str);
            str=''
        }
        for(let i=0; i<$("#orderdetail_front").find(".receipttext").length;i++){//주문내역 계산해서 후불결제에 넣기
          let price = stringNumberToInt($("#orderdetail_front").children('.receipttext:eq('+i+')').find('#price_menu, #price_room').html().split('원')[0])
          sumprice+=price
        }
        $("#presell").html(data.room[0].fpay.toLocaleString()+"원")
        $("#nextsell").html(sumprice.toLocaleString()+"원")
        let allprice = stringNumberToInt($("#presell").html().split('원')[0]) +stringNumberToInt($("#nextsell").html().split('원')[0])
        $("#allsell").html(allprice.toLocaleString()+"원")
        console.log($("#allsell").html())
        $(".btnarea2").css("display","flex");
        if( $("#allsell").html()=='0원'){
          $(".btnarea2").css("display","none");
        }
        $("#pop_receipt").css("display","flex");
        $(".popup").css("display","flex"); // 영수증 팝업 - 주문 내역 DB 와 연결
        console.log("후불결제",$("#nextsell").html())
        $("#memoPrv_"+data.room[0].idx).html('결제 예정: '+$("#nextsell").html());
      } else {
       }
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
   }
  function calculate(way){ // 상세 결제 내역 카드나 현금 눌렀을 때 임시로 order테이블 gidx +1 해주기(결제 대체)
    let nextsell = stringNumberToInt($("#nextsell").html().split('원')[0])
    console.log("nextsell",nextsell)
    $.ajax({
      type : 'get' , 
      url : '/ordersell?idx='+r_idx+'&way='+way+"&nextsell="+nextsell , 
    }).done(function(data){        
      if(data.result == 'success'){
        $(".front_receiptpop").css("display","none");
        listRoom()
        roomendwait(r_idx,r_roomNm)
        roomendcustomer(r_idx,r_roomNm)
      }
      $(".totalpayment_pop2").css('display','flex')// 적립 정보 입력 팝업 띄우기
      $(".popup").css('display','flex');
      $("#point_NextPrice").html(nextsell.toLocaleString()+'원')
      $("#point_TotalPrice").html(nextsell.toLocaleString()+'원')
      totalPoint(nextsell)
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  var point_save = 0
  var input_num = ''
  var phonenumber=0
  //포인트 적립 - 전화번호 입력
  function pointNum(num){
    if (num == '-1' && $("#point_number").val().length > 0){//지움 눌렀을 때
      console.log("1",$("#point_number").val())
      input_num = $("#point_number").val().slice(0, -1);
    } else if (num != '-1' && $("#point_number").val().length < 11) {
      console.log("2",$("#point_number").val())
      input_num += num;
    }
    $("#point_number").val(input_num);
    phonenumber = $("#point_number").val();
  }
  function totalPoint(price){
    console.log("price",price)
    $.ajax({
      type : 'get' , 
      url : '/getPointPercent' ,
    }).done(function(data){
      console.log("percent",data.percent[0].rrate);
      let point = price*data.percent[0].rrate/100
      $("#all_point").html(point.toLocaleString()+'pt')
      point_save = point
      console.log("point_save",point_save)
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })           
  }
  function savePoint(){
    console.log("number!,",phonenumber)
    $.ajax({
      type : 'get' , 
      url : '/getsavePoint_front?number='+phonenumber+'&point='+point_save ,
    }).done(function(data){
      if(data.result == 'success'){
        commonpay("결제 및 적립이 완료되었습니다.",'end')
      } else {
        commonpay(data.msg)
      }            
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })           
  }
  function commonpay(con,end){
    $("#commonment").html(con)
    $("#commonpay").css('display','flex');
    $(".popup").css('display','flex');
    setTimeout(function(){$("#commonpay").css('display','none');},1000);
    if(end=='end'){
      closePop()
      $("#commonment").html(con)
      $("#commonpay").css('display','flex');
      $(".popup").css('display','flex');
      setTimeout(function(){$("#commonpay").css('display','none');},1000);
      setTimeout(function(){$(".popup").css('display','none');},1000);
    }
  }
  // 예약된 방을 표시하는 경우, 사용자가 키오스크 체크인시 이용중으로, 시작 시간 이후에는 빨간색으로 표시하다가 30분이 지나도 미입장시 자동 취소 처리
  $(".front_top-alarm").click(function () {
    $("#wait").slideUp(200);
    $(this).siblings(".front_togglebox").slideToggle(200);
  });
  $(".front_topbtn").click(function () {
    $("#alarm").slideUp(200);
    $(this).siblings(".front_togglebox").slideToggle(200);
  });
  $(".macrolistbtn").click(function () {
    $(this).siblings(".macro_slider").slideToggle(200);});
  $(document).ready(function(){          
    $(".macrolist_warp").on('click', function(){       
      $(".macrolist_warp").css("display","flex")
      $(".macro_slider").css("display","block")  
    })
  })
  function closechattingbox(){
    $("[id*=chatDetail_]").css("display","none");
    $("#chatSendBtn").attr("href" , "javascript:void(0)")
    $("#chat").attr("onkeypress" , "if(event.keyCode == 13) { javascript:void(0); return false;}")
    $(".chatbord").css("display","none");
    $("#chattingbox").css("display","none")
    $(".macrolist_warp").css("display","none")
    $(".chattingbar").css("display","none");
    $("#chattingroomboard").css("display","flex");
  }
  // function openchattingbox(idx){ //채팅방 idx에 따라 해당 채팅방 열기
  //   $("[id*=chatDetail_]").css("display","flex");
  //   $("#chatSendBtn").attr("href" , "javascript:void(0)")
  //   $("#chat").attr("onkeypress" , "if(event.keyCode == 13) { javascript:void(0); return false;}")
  //   $(".chatbord").css("display","flex");
  //   $("#chattingbox").css("display","flex")
  //   $(".macrolist_warp").css("display","flex")
  //   $(".chattingbar").css("display","flex");
  //   $("#chattingroomboard").css("display","none");
  // }
  function openPop(id){
    console.log("openpop")
    $(".front_togglebox").css("display","none");
    $("#"+id).css("display","flex");
    $(".popup").css("display","flex");
    if(id=='pop_todo'){
      todopop()
    }
  }
  // function openInnerPop(id){
  //   $("#"+id).css("display","flex");
  //   $("#pop_inner").css("display","flex");
  //   $(".popup").css("display","flex");
  //   if(id == 'pop_confirm'){
  //     todocomplete()
  //   }
  // }
  function closeInnerPop(id){
    $("#"+id).css("display","none");
    if(end=='end'){
      colsePop()
    }
  }
  function closePop(){
    $(".totalpayment_pop2").css("display","none")
    $("[id*=pop_]").css("display","none");
    $("#calsuccess").css("display","none");
    $(".front_foodpop").css("display","none");
    $(".popup").css("display","none");
    $("#commonalarmpop").css("display","none");
    $(".div-block-53").html('')
    $("#orderdetail_front").html('')
    $("#reser_Info").html('')
    $("#todonumber").val('')
    $("#todo_list").html('')
    $(".w-checkbox-input").prop("checked",false)
    $("#point_number").val(''); // 전화번호 입력창 초기화 
    input_num=''
    phonenumber=0
  }
  function closealarmPop(self){
    $(self).parents(".alarm_warp").remove();
    countMinus('alarmcount_')
  }
  function todopop(){
    $("#todo_list").html('')
    $.ajax({
      type : 'get' , 
      url : '/front/todopop',           
    }).done(function(data){
        if(data.result == 'success'){      
          let str='';
          if(data.todo.length==0){
            str='<div class="text-block-13" style="width:100%; margin-top:15%">수행 목록이 없습니다</div>'
          }
          else{
            for(var i=0; i<data.todo.length; i++){
            str+=' <label class="w-checkbox checkbox-field"><input type="checkbox" id="contentid" name ="content_id" value="'+data.todo[i].idx+'"  class="w-checkbox-input"><span class="checkbox-label w-form-label" for="checkbox-2">'+data.todo[i].content+'</span></label>'
            }
          }
          $("#todo_list").append(str)
          completeTodoShow()
        }            
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  var number4 =0;
  var content=[];
  function todocomplete(){
    content=[];
    let data = $("#todolistForm").serialize();
    console.log("data11111",data)
    
    $.ajax({
      type : 'post' , 
      url : '/front/todomembercheck',      
      data : data , 
      dataType : 'json' ,        
    }).done(function(data){
        if(data.result == 'success'){
          $("#staff_name").html('')
          $("#pop_inner").css("display","flex");
          $("#pop_todo").css("display","flex");
          $("#pop_confirm").css("display","flex");
          $(".popup").css("display","flex");
          $("#number4").html(data.number+'번')
          let str=''
          for(var i=0; i<data.member.length; i++){
            str+='<option value="'+data.member[i].idx+'">'+data.member[i].name+'</option>'
          }
          $("#staff_name").append(str)
        }      
        else if(data.result == "fail"){
          alarmment(data.msg)
        }
        console.log("content",data.content,data.content.length ,Array.isArray(data.content))
        if(Array.isArray(data.content)==true){
          for(var i=0;i<data.content.length;i++){
            content.push(data.content[i])
          }
        }
        else{
          content=data.content
        }
        console.log("content~~~",content)
        number4 = data.number;
        
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  function alarmment(content){
    $("#alarmment").html(content)
    $("#commonalarmpop").css('display','flex')
    $(".popup").css('display','flex')
  }
  function todocomplete_last(){
    closeInnerPop('pop_inner');
    let str='';
    if(Array.isArray(content)==true){
      for(var i=0;i<content.length;i++){
        str+='&content='+content[i];
      }
    }else{
      str+='&content='+content;
    }
    let data = $("#staffForm").serialize()+"&number4="+number4+str;
    $.ajax({
      type : 'post' , 
      url : '/front/todocomplete',      
      data : data , 
      dataType : 'json' ,        
    }).done(function(data){
      completeTodoShow()
      todopop()
      $("#todonumber").val('')
      alarmment(data.msg)
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  function completeTodoShow(){
    $("#todo_endlist").html('')
    $.ajax({
      type : 'get' , 
      url : '/front/todoshow',           
    }).done(function(data){
      if(data.result == 'success'){      
          let str='';
          if(data.todo.length==0){
            str='<div class="text-block-13" style="width:100%; margin-top:15%">완료된 업무가 없습니다</div>'
          }else{
            for(var i=0; i<data.todo.length; i++){
            str+='<div class="todo_complete"><div class="todo_c_title">'+data.todo[i].content+'</div><div class="todo_c_name" style="font-size:15.5px;">'+data.todo[i].number4+data.todo[i].name+'</div></div>'
            }
          }
          $("#todo_endlist").append(str)
        }            
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  function getReservation(){ //예약 현황 불러오기
    openPop('pop_reserve');
    $.ajax({
      type : 'get' , 
      url : '/front/reservationInfo',           
    }).done(function(data){
        if(data.result == 'success'){      
          $("#reservationlist").html('예약 현황')    
          let txt = "";          
          if (data.today.length != 0){
            for(var i = 0; i<data.today.length; i++){
              txt += '<div class="front_listbox1"><div>'+data.today[i].roomNm+'번 방 | 예약자: '+data.today[i].name+' | 전화번호: '+data.today[i].number.replace(/^(\d{2,3})(\d{3,4})(\d{4})$/,`$1-$2-$3`)+'</div>';
              txt += '<div class="text-block-13">방 정보: '+data.today[i].peopleMin+'~'+data.today[i].peopleMax+'인실 | 시작 시간:'+dateTimeFormat(data.today[i].stime)+'  | 사용 시간: '+data.today[i].duration+'분</div>'
              txt += '<input type="hidden" name="idx" value="'+data.today[i].idx+'"><button type="button" class="button-22-copy w-button" onclick="cancelReservation(`'+data.today[i].idx+'`)"/>예약취소</button></div>'
            } 
          }  else {
            txt += '<div style = "text-align:center; width:100%; height:100%; display:flex;align-items: center;">';
            txt += '<div class="text-block-13" style = "width:100%;">예약 정보가 없습니다</div></div>';
            }
            $("#reser_Info").html(txt);
        }            
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  function cancelReservation(Oidx){ //예약 취소
    $.ajax({
            type : 'get' , 
            url : '/front/reservationCancelProcess?idx='+Oidx, 
    }).done(function(data){                
        if(data.result == 'success'){
          closePop();
          getReservation();
          reservationlisting()
          roomendwait(data.room_idx[0].idx,data.room_idx[0].roomNm)
        }            
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  function macroopen(){
    $(".macro_slider").html()
    $.ajax({
            type : 'get' , 
            url : '/front/macroopen', 
    }).done(function(data){                
        if(data.result == 'success'){
          let str=''
          for(var i=0; i< data.macro.length; i++){
            str+='<a href="javascript:macro(\''+data.macro[i].macro+'\')" class="link-block-21 w-inline-block">'
            str+='<div>'+data.macro[i].macro+'</div></a>'
          }
          $(".macro_slider").html(str)
        }            
    }).fail(function(e){
            console.log(JSON.stringify(e));
    })
  }
  //공통함수
  function stringNumberToInt(stringNumber){// 숫자 ,로 변환된 문자열을 계산 전에 정수형으로 바꿔줌
    return parseInt(stringNumber.replace(/,/g , ''));
  }
  function dateTimeFormat(sdate) {
    let date = new Date(sdate);
    let month = date.getMonth() + 1;
    let day = date.getDate();
    let hour = date.getHours();
    let minute = date.getMinutes();
    let second = date.getSeconds();

    month = month >= 10 ? month : '0' + month;
    day = day >= 10 ? day : '0' + day;
    hour = hour >= 10 ? hour : '0' + hour;
    minute = minute >= 10 ? minute : '0' + minute;
    second = second >= 10 ? second : '0' + second;

    return hour + ':' + minute;
}

function savetimeformat(sdate,duration,duration_add) {//남은 시간 구해주는 함수
    let date = new Date(sdate);
    date.setMinutes(date.getMinutes()+(duration+duration_add))//date = 시작시간+사용시간 / 즉 종료시간
    let hour = date.getHours();
    let minute = date.getMinutes();

    let now = new Date();//현재시간
    let savetime = date.getTime()-now.getTime();//종료시간 - 현재시간 // timestamp값으로 나옴
    var hour2 = Math.floor((savetime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minute2 = Math.floor((savetime % (1000 * 60 * 60)) / (1000 * 60));
    if(minute2<10){
      minute2 = '0'+minute2
      console.log("minute22",minute2)
    }
    return hour2 + ':' + minute2;
}
function dateTimeOfficialFormat(sdate) {//input란에 ISO 시간대로 입력하기 위한 포맷
    let date = new Date(sdate);
    let hour = date.getHours();
    let minute = date.getMinutes();
  
    hour = hour >= 10 ? hour : '0' + hour;
    minute = minute >= 10 ? minute : '0' + minute;
  
    return hour + ':' + minute ;
  }
  </script>
