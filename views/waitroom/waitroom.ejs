<!DOCTYPE html><!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Thu Mar 31 2022 01:51:32 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="6204cbf0c9e18c152a147b71" data-wf-site="61fb361452ff0215fe4db1db">
<head>
  <meta charset="utf-8">
  <title>Waitroom_screen</title>
  <meta content="Waitroom_screen" property="og:title">
  <meta content="Waitroom_screen" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../user/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../user/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../user/css/zemeet.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Noto Sans KR:100,300,regular,500,700,900:korean,latin"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../user/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../user/images/webclip.png" rel="apple-touch-icon">
</head>
<body class="wait_body">
  <!-- ================================================================================================ -->
  <!-- HOME -->
  <div class="frame" id="homebody" style="display:flex;" >
    <div class="waitroom_container">
      <div class="wait_section"><img src="../user/images/zemeet_logo.svg" loading="lazy" alt="" class="waitroom_logo">
        <a href="#" class="button-5 w-button" onclick="clickroom()">방 목록 보기</a>
        <div class="wait_block1">
          <div class="advertisement_back">
            <div class="video w-video w-embed"></div>
            <div class="advertisement_black"><img src="../user/images/Touch_icon.svg" loading="lazy" alt="" class="image-14">
              <div class="text-block-7">터치하세요.</div>
            </div>
          </div>
        </div>
        <div class="wait_block2">
          <div class="title2">이용안내</div>
          <div class="text-block-6">운영시간<br><br>평일 11 : 00 ~ 24:00<br>주말 11 : 00 ~ 02:00<br>공휴일 11 : 00 ~ 02:00</div>
        </div>
      </div>
    </div>
  </div>
  <!-- ============================================================================================== -->
  <!-- ROOM -->
  <div class="frame_wait" id="roombody" style="display:none;">
    <div class="waitroom_container">
      <div class="wait_section"><img src="../user/images/zemeet_logo.svg" loading="lazy" alt="" class="waitroom_logo">
        <a href="javascript:returnpop()" class="button-6 w-button">뒤로가기</a>
        <div class="wait_room_block">
          <div class="roomscroll" >
          </div>
          <div class="wait_buyroom_warp">
            <div class="warn">*이용 수칙*<br>
              <div class="warn"><br>1. 외부음식 반입 금지<br></div>
              <div class="warn"><br>2. 방마다 보드게임 하나씩만 가능 <br></div>
              <div class="warn"><br>3. 사용한 보드게임은 정리 후 제자리<br></div>
            </div>
            <div class="div-block-27">
              <div class="w-form">
                <form id="option-form" name="email-form" data-name="Email Form" method="post">
                  <div>인원 설정</div><select id="people_option" name="people_option" data-name="Field 2" class="select-field-2 w-select">
                    <option value="1"<% if(peopleType == '1'){ %> selected  <% } %>>인원을 선택해주세요..</option>
                    <option value="2"<% if(peopleType == '2'){ %> selected  <% } %>>2명</option>
                    <option value="3"<% if(peopleType == '3'){ %> selected  <% } %>>3명</option>
                    <option value="4"<% if(peopleType == '4'){ %> selected  <% } %>>4명</option>
                    <option value="5"<% if(peopleType == '5'){ %> selected  <% } %>>5명이상</option>
                  </select>
                </form>
              </div>
              <a href="javascript:optionselect()" class="button-19 w-button">옵션 설정</a>
            </div>
          </div>
        </div>
        <a href="javascript:reservecheck('kiosk_popbox._pop2')" class="button-6 _2 w-button">예약 확인</a>
      </div>
      <!-- ================================================================================= -->
      <!-- 해당 방 선택 팝업  -->
      <div class="wait_buyroomblock" style="display:none;" id = "roomblock_">
        <div class="room_preview"><img src="/" loading="lazy" width="867" sizes="100vw" alt="" class="image-23" id = "roomImg1">
          <div class="room_preview_imgblock"></div>
        </div>
        <div class="room_previewinfo">
          <div class="text-block-11" id = "roomName"></div>
          <div id = "roomPeople"></div>
          <a href="#" class="button-8 w-button" id = "toBuyPop" onclick ="roomPop('buypop_box')">해당 방 선택</a>
        </div>
        <a href="javascript:closePop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
      </div>
    </div>
    <!-- ================================================================================== -->
    <!-- 팝업 -->
    <div class="pop" style="display:none;">
      <div class="commonpop" style="display:none;">
        <div class="commonpopbox">
          <div>결제 되었습니다.</div>
        </div>
      </div>
      <div class="reservecheck_pop" style="display:none;">
        <div class="kiosk_popbox _pop2" style="display:none;">
          <div class="poptitle">예약 확인</div>
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="pop_box">
            <div>선 예약자 이십니까?</div>
            <div class="pop_warntxt">주의문구</div>
          </div>
          <div class="btnwarp">
            <a href="javascript:reservecheck('reserveinput_pop')" class="kioskpop_btn w-button">예</a>
            <a href="javascript:closeRoomPop()" class="kioskpop_btn _2 w-button">아니오</a>
          </div>
        </div>
        <div class="reserveinput_pop" style="display:none;">
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">예약 정보 입력</div>
          <div class="reserveinput_warp">
            <div>예약정보 확인을 위해 전화번호를 입력해 주십시오.</div>
            <div class="form-block-15 w-form">
              <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="get">
                <div class="totalpayment_textarea"><input type="text" class="telephoneinput w-input" maxlength="11" name="number" id="reserver_number" placeholder="전화번호를 입력해주세요." required=""></div>
              </form>
            </div>
            <div class="telephone_grid2">
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c855-9edf0637" href="javascript:phoneNum(1)" class="telephne_btn w-inline-block">
                <div>1</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c858-9edf0637" href="javascript:phoneNum(2)" class="telephne_btn w-inline-block">
                <div>2</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c85b-9edf0637" href="javascript:phoneNum(3)" class="telephne_btn w-inline-block">
                <div>3</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c85e-9edf0637" href="javascript:phoneNum(4)" class="telephne_btn w-inline-block">
                <div>4</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c861-9edf0637" href="javascript:phoneNum(5)" class="telephne_btn w-inline-block">
                <div>5</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c864-9edf0637" href="javascript:phoneNum(6)" class="telephne_btn w-inline-block">
                <div>6</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c867-9edf0637" href="javascript:phoneNum(7)" class="telephne_btn w-inline-block">
                <div>7</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c86a-9edf0637" href="javascript:phoneNum(8)" class="telephne_btn w-inline-block">
                <div>8</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c86d-9edf0637" href="javascript:phoneNum(9)" class="telephne_btn w-inline-block">
                <div>9</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c870-9edf0637" href="javascript:phoneNum(-1)" class="telephne_btn _2 w-inline-block">
                <div>지움</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c873-9edf0637" href="javascript:phoneNum(0)" class="telephne_btn w-inline-block">
                <div>0</div>
              </a>
              <a id="w-node-b0f8d45b-d29a-e0c5-4c09-507586a6c876-9edf0637" href="javascript:phoneReserveCheck()" class="telephne_btn _3 w-inline-block" >
                <div>확인</div>
              </a>
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:phoneReserveCheck()" class="telephone_btn w-button">확인</a>
            <a href="javascript:closeRoomPop()" class="telephone_btn _2 w-button">취소</a>
          </div>
        </div>
        <div class="reserveselect_pop" style="display:none;">
          <div class="poptitle">예약 정보 확인</div>
          <div>예약정보를 확인해 주세요.</div>
          <div class="reserveinput_scroll" id = "reser_list">
          </div>
          <div class="btnarea2">
            <a href="javascript:food2()" class="telephone_btn w-button">확인</a>
            <a href="javascript:closeRoomPop()" class="telephone_btn _2 w-button">취소</a>
          </div>
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
        </div>
      </div>
      <!-- wait_buyroomblock 연결 팝업 -->
      <div class="waitroom_roompop" style="display:none; z-index: 100000;" >
        <div class="waitroom_popbox">
          <div>이미 선택된방입니다</div>
        </div>
      </div>
      <!-- // -->
      <!-- 방 구매 팝업( 이전 다음 연결) -->
      <div class="buypop" style="display:none;">
        <div class="buypop_box" style="display:none;" >
          <div class="poptitle">방 선택 옵션</div>
          <div class="buypop_section">
            <div class="buypop_block1">
              <div id = "roomName2"></div>
              <input type = "hidden" value = "" id = "h_Oidx">
              <div data-delay="4000" style="width:100%;" data-animation="fade" class="slider-2 w-slider" data-autoplay="true" data-easing="ease" data-hide-arrows="true" data-disable-swipe="true" data-autoplay-limit="0" data-nav-spacing="10" data-duration="500" data-infinite="true">
                <div class="w-slider-slicker" id = "roomPic" style="width:100%;position:absolute;top:0;left:0;right:0;bottom:0;max-width:100%;height:100%;object-fit:cover; background-size:100% 100%;overflow:hidden;"></div>
              </div>
              <div class="buypop_previewblock">
                <!-- <a href="#" class="link-block-12 w-inline-block"><img src="" loading="lazy" alt="" class="image-13" id = "roomImg3_1"></a>
                <a href="#" class="link-block-12 w-inline-block"><img src="" loading="lazy" alt="" class="image-13" id = "roomImg3_2"></a>
                <a href="#" class="link-block-12 w-inline-block"><img src="" loading="lazy" alt="" class="image-13" id = "roomImg3_3"></a>
                <a href="#" class="link-block-12 right w-inline-block"><img src="" loading="lazy" alt="" class="image-13" id = "roomImg3_4"></a> -->
              </div>
            </div>
            <div class="buypop_section2">
              <div class="api_warn" style = "color:#fad17f; margin-bottom:-7px; margin-left:43px;">   *시간은 30분부터 선택이 가능합니다.</div>
              <div class="buypop_block2">
                <div>구매 옵션</div>
                <div class="buy_warp">
                  <div>시간(분)</div>
                  <div class="unitblock">
                    <a href="javascript:plusOrMinus('duration','0')" class="unit_btn w-inline-block">
                      <div>-</div>
                    </a>
                    <div id = "total_duration" >30</div>
                    <a href="javascript:plusOrMinus('duration','1')" class="unit_btn w-inline-block">
                      <div>+</div>
                    </a>
                  </div>
                </div>
                <div class="buy_warp">
                  <div>인원수</div>
                  <div class="unitblock">
                    <a href="javascript:plusOrMinus('people','0')" class="unit_btn w-inline-block" id = "people_minus">
                      <div>-</div>
                    </a>
                    <div id = "total_people">1</div>
                    <a href="javascript:plusOrMinus('people','1')" class="unit_btn w-inline-block" id = "people_plus">
                      <div>+</div>
                    </a>
                  </div>
                </div>
                <div class="text-block-10" style = "color:#fad17f;">총 <span class="text-span-6" id = "roomPrice"></span>원</div>
                <a href="javascript:food1()" class="button-9 w-button" id="available_button" >방선택 완료</a>
                <a href="#" class="button-9 block w-button" id="unavailable_button"  style = "display:none;">방선택 불가</a>
              </div>
            </div>
          </div>
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <a href="javascript:closeRoomPop()" class="buypop_btn prev w-inline-block"><img src="../user/images/chevron-left.svg" loading="lazy" alt="" class="buypop_arrow">
            <div>이전</div>
          </a>
        </div>
        <div class="foodpop_box" id="foodpop1"  style="display:none;">
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">음식 선택</div>
          <a href="javascript:roomPop('buypop_box')" class="buypop_btn prev w-inline-block"  id = "toBefore"><img src="../user/images/chevron-left.svg" loading="lazy" alt="" class="buypop_arrow">
            <div>이전</div>
          </a>
          <div class="foodpop_innerbox">
            <div class="foodpop_warp1">
              <div>
                <div class="foodpop_togglewarp">
                  <a href="#" class="foodpop_togglebtn w-inline-block" onclick="clickFood(this,'Food','1')">
                    <div>Food Menu</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="foddpop_arrow">
                  </a>
                  <div class="foodpop_toggle" id="Foodbox1">
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                  </div>
                </div>
                <div class="foodpop_togglewarp">
                  <a href="#" class="foodpop_togglebtn w-inline-block"  onclick="clickFood(this,'Cafe','1')">
                    <div>Cafe Menu</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="foddpop_arrow">
                  </a>
                  <div class="foodpop_toggle" id="Cafebox1">
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                  </div>
                </div>
                <div class="foodpop_togglewarp">
                  <a href="#" class="foodpop_togglebtn w-inline-block" onclick="clickFood(this,'Pub','1')">
                    <div>Pub Menu</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="foddpop_arrow">
                  </a>
                  <div class="foodpop_toggle" id="Pubbox1">
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
            <div class="foodpop_warp2">
              <div>
                <div class="food_orderbox_top">
                  <div class="food_selecttxt">상품이름</div>
                  <div class="food_selecttxt">가격</div>
                  <div class="food_selecttxt">수량</div>
                  <div class="food_selecttxt cancle">삭제</div>
                </div>
              </div>
              <div class="foodselect_area" id="foodselect_area_1">
              </div>
              <div class="foodselect_orderblock">
                <div class="foodselect_orderwarp">
                  <div class="foodselect_ordertxt" style = "color:#fad17f;">총 주문금액 <div><span class="pricespan" id =foodPrice1>0원</span></div></div>
                </div>
              </div>
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:total1('1','noadd')" class="button-32 btnarea2 w-button">추가안함</a>
            <a href="javascript:total1('1')" class="button-32 w-button">담기</a>
          </div>
        </div>
        <div class="foodpop_box" id="foodpop2" style="display:none;">
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">음식 선택</div>
          <a href="javascript:reservecheck('reserveselect_pop')" class="buypop_btn prev w-inline-block"><img src="../user/images/chevron-left.svg" loading="lazy" alt="" class="buypop_arrow">
            <div>이전</div>
          </a>
          <div class="foodpop_innerbox">
            <div class="foodpop_warp1">
              <div>
                <div class="foodpop_togglewarp">
                  <a href="#" class="foodpop_togglebtn w-inline-block" onclick="clickFood(this,'Food','2')">
                    <div>Food Menu</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="foddpop_arrow">
                  </a>
                  <div class="foodpop_toggle" id="Foodbox2">
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                  </div>
                </div>
                <div class="foodpop_togglewarp">
                  <a href="#" class="foodpop_togglebtn w-inline-block" onclick="clickFood(this,'Cafe','2')">
                    <div>Cafe Menu</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="foddpop_arrow">
                  </a>
                  <div class="foodpop_toggle" id="Cafebox2">
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                  </div>
                </div>
                <div class="foodpop_togglewarp">
                  <a href="#" class="foodpop_togglebtn w-inline-block" onclick="clickFood(this,'Pub','2')">
                    <div>Pub Menu</div><img src="../user/images/Icon-awesome-caret-down.svg" loading="lazy" alt="" class="foddpop_arrow">
                  </a>
                  <div class="foodpop_toggle" id="Pubbox2">
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                    <a href="#" class="link-block-24 w-inline-block"><img src="../user/images/img1.png" loading="lazy" alt="" class="foodpop_img">
                      <div class="foodselect_info">파 송송 신라면 신라면신라면신라면<span class="food_price">4,500원</span></div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
            <div class="foodpop_warp2">
              <div>
                <div class="food_orderbox_top">
                  <div class="food_selecttxt">상품이름</div>
                  <div class="food_selecttxt">가격</div>
                  <div class="food_selecttxt">수량</div>
                  <div class="food_selecttxt cancle">삭제</div>
                </div>
              </div>
              <div class="foodselect_area" id="foodselect_area_2">
              </div>
              <div class="foodselect_orderblock">
                <div class="foodselect_orderwarp">
                  <div class="foodselect_ordertxt">총 주문금액<div><span class="pricespan" id =foodPrice2>0원</span></div></div>
                </div>
              </div>
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:ReserUseRoom()" class="button-32 btnarea2 w-button">추가안함</a>
            <a href="javascript:total2('2')" class="button-32 w-button">담기</a>
          </div>
        </div>
        
        <div class="totalpayment_box" id="total1"  style="display:none;">
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">총 결제액</div>
          <a href="javascript:food1()" class="buypop_btn prev w-inline-block"><img src="../user/images/chevron-left.svg" loading="lazy" alt="" class="buypop_arrow">
            <div>이전</div>
          </a>
          <div class="totalpayment_warp">
            <div class="totalpayment_block1">
              <div class="totalpatment_block1">
                <div>게임방</div>
                <div class="total_price" id = "precisePrice1">50000원</div>
              </div>
              <div class="totalpatment_block2">
                <div class="totalpayment_txt"><span id="roomTime_all">dd</span><span id="roomPrice_all">3000</span></div>
              </div>
            </div>
            <div class="totalpayment_block1">
              <div class="totalpatment_block1">
                <div>음식<span class='identify'>(후불)</span></div>
                <div class="total_price" id="food_price1">0원</div>
              </div>
              <div class="totalpatment_block2" id="foodtotal1">
              </div>
            </div>
            <div class="totalpayment_block2">
              <div class="div-block-46">
                <div class="total_reward_box2">
                  <div>총 적립액</div>
                </div>
                <div class="total_reward_box1" id="total_point1">
                  <div>1,000 pt</div>
                </div>
              </div>
              <div class="totalprice_txt" style = "color:#fad17f;">총 합계 <div><span class="pricespan" id = "total_price1"></span></div></div>
              <!-- <div class="totalprice_txt">총 합계 <span class="pricespan">8,000원</span></div> -->
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:kioskroommenu('1')" class="button-32 w-button" id="available_calbutton">결제</a>
            <a href="#" class="button-9 block w-button" id="unavailable_calbutton"  style = "display:none; margin-top:0px;">결제 불가</a>
          </div>
        </div>
        <div class="totalpayment_box" id="total2"  style="display:none;">
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">총 결제액</div>
          <a href="javascript:food2()" class="buypop_btn prev w-inline-block"><img src="../user/images/chevron-left.svg" loading="lazy" alt="" class="buypop_arrow">
            <div>이전</div>
          </a>
          <div class="totalpayment_warp">
            <div class="totalpayment_block1">
              <div class="totalpatment_block1">
                <div>음식<span class='identify'>(후불)</span></div>
                <div class="total_price" id="food_price2">1,000</div>
              </div>
              <div class="totalpatment_block2" id="foodtotal2">
                <div class="totalpayment_txt">기본 이용시간 <span>20.000</span></div>
              </div>
            </div>
            <div class="totalpayment_block2">
              <div class="totalprice_txt">총 합계<span class="pricespan" id="total_price2">8,000원</span></div>
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:kioskmenu(2)" class="button-32 w-button">주문</a>
          </div>
        </div>
      </div>
      <div class="totalpayment_pop2" style="display:none;">
        <div class="totalpayment_box2">
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="poptitle">적립 정보 입력</div>
          <div class="totalpayment_warp2">
            <div>포인트 적립을 위해 적립할 전화번호를 입력해주세요.</div>
            <div class="form-block-15 w-form">
              <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="get">
                <div class="totalpayment_textarea"><input type="text" class="text-field-9 w-input" maxlength="11" name="field-3" placeholder="전화번호를 입력해주세요." id="point_number" required=""></div>
              </form>
            </div>
            <div class="div-block-50">
              <div class="telephone_grid">
                <a id="w-node-_0d5d74f5-55e2-5d4c-5502-60dcc1e5e3d0-9edf0637" href="javascript:pointNum(1)" class="telephne_btn w-inline-block">
                  <div>1</div>
                </a>
                <a id="w-node-aec9ed9b-7079-1a2a-7789-0b4683f04f13-9edf0637" href="javascript:pointNum(2)" class="telephne_btn w-inline-block">
                  <div>2</div>
                </a>
                <a id="w-node-f386cdc9-37a8-f55b-135c-59a8722e4b79-9edf0637" href="javascript:pointNum(3)" class="telephne_btn w-inline-block">
                  <div>3</div>
                </a>
                <a id="w-node-c4018bb8-26de-dabd-1a64-db34eddaa405-9edf0637" href="javascript:pointNum(4)" class="telephne_btn w-inline-block">
                  <div>4</div>
                </a>
                <a id="w-node-_7378ffba-59c9-8e08-6bdf-9864ac2e4cf4-9edf0637" href="javascript:pointNum(5)" class="telephne_btn w-inline-block">
                  <div>5</div>
                </a>
                <a id="w-node-_1051b182-1f24-05c1-9bbf-c01be33c10c8-9edf0637" href="javascript:pointNum(6)" class="telephne_btn w-inline-block">
                  <div>6</div>
                </a>
                <a id="w-node-_3d6b143c-586e-5962-109e-bad1ef3e20ab-9edf0637" href="javascript:pointNum(7)" class="telephne_btn w-inline-block">
                  <div>7</div>
                </a>
                <a id="w-node-ee22ed87-1a19-dd3e-e2fe-5c81ad757d4d-9edf0637" href="javascript:pointNum(8)" class="telephne_btn w-inline-block">
                  <div>8</div>
                </a>
                <a id="w-node-_2926f3c5-5fb7-7caf-130e-7d224aa7ffd1-9edf0637" href="javascript:pointNum(9)" class="telephne_btn w-inline-block">
                  <div>9</div>
                </a>
                <a id="w-node-fcae5b66-f626-b92c-d9f0-5b5b2a732ff4-9edf0637" href="javascript:pointNum(-1)" class="telephne_btn _2 w-inline-block">
                  <div>지움</div>
                </a>
                <a id="w-node-a109d601-9088-3178-2c64-667ef582073e-9edf0637" href="javascript:pointNum(0)" class="telephne_btn w-inline-block">
                  <div>0</div>
                </a>
                  <a href="javascript:savePoint()" class="telephne_btn _3 w-inline-block" style="margin-left:16px;">
                  <div>확인</div>
                </a>
              </div>
              <div class="totalpayment_section">
                <div class="title">총 결제금액</div>
                <div class="div-block-52">
                  <div class="totalprice_txt2">방<span class="pricespan2" id="point_RoomPrice">8,000원</span></div>
                </div>
                <div class="div-block-52">
                  <div class="totalprice_txt2">음식<span class="pricespan2" id="point_FoodPrice">8,000원</span></div>
                </div>
                <div class="div-block-51">
                  <div class="totalprice_txt">총 합계 <span class="pricespan" id="point_TotalPrice">8,000원</span></div>
                </div>
                <div class="accumulate_area_f">
                  <div class="totalprice_txt3">적립액</div>
                  <div class="accumulate_txtbox_f" id="all_point">0</div>
                </div>
              </div>
            </div>
          </div>
          <div class="btnarea2">
            <a href="javascript:commonpay('결제 되었습니다.')" class="button-32 _2 w-button">취소</a>
          </div>
        </div>
      </div>
      <div class="kioskpop" style="display:none; z-index: 100000;" >
        <div class="kiosk_popbox _pop1">
          <div class="poptitle">알림</div>
          <a href="javascript:closeRoomPop()" class="popexist w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="exsiticon"></a>
          <div class="pop_box">
            <div>적립 하시겠습니까?</div>
            <div class="pop_warntxt">적립 시 주의문구</div>
          </div>
          <div class="btnwarp">
            <a href="javascript:pointpop()" class="kioskpop_btn w-button">확인</a>
            <a href="javascript:commonpay('결제 되었습니다.')" class="kioskpop_btn _2 w-button" >취소</a>
          </div>
        </div>
      </div>
      <div class="food_canclepop" id="orderfail" style="display:none; z-index: 100000;">
        <div class="nomalpop_box">
          <div class="poptitle">알림</div>
          <div class="nomalpop_warp">
            <div>메뉴를 담아주세요.</div>
          </div>
          <div class="btnarea2">
            <a href="#" class="button-31 w-button" onclick="closeRoomPop('orderfail')">확인</a>
          </div>
        </div>
      </div>
      <input type = "hidden" id = "send_duration" value = "1" />
      <input type = "hidden" id = "send_people"/>
      <input type = "hidden" id = "send_price"/>
    </div>
  </div>

  <script src="../js/socket.js" type="text/javascript"></script>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=61fb361452ff0215fe4db1db" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../user/js/webflow.js" type="text/javascript"></script>
  <%-include('../apiFrame/api_slick.ejs') %>
  <style>
    .roomscroll::-webkit-scrollbar {
    width: 4px;
    height:4px;
    }
    .roomscroll::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    }
    .foodpop_warp1::-webkit-scrollbar {
    width: 4px;
    height:4px;
    }
    .foodpop_warp1::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    }
    .foodselect_area::-webkit-scrollbar {
    width: 4px;
    height:4px;
    }
    .foodselect_area::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    }
    .totalpatment_block2::-webkit-scrollbar {
    width: 4px;
    height:4px;
    }
    .totalpatment_block2::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    }
    .reserveinput_scroll::-webkit-scrollbar {
    width: 4px;
    height:4px;
    }
    .reserveinput_scroll::-webkit-scrollbar-thumb {
    background: #a9a9a9;
    border-radius:20px;
    opacity:50%;
    }
    .w-slider-dot {
    width:40px;
    height:5px;
    background:white;
    opacity:30%; 
    border-radius:20px;
    }
   .w-slider-dot.w-active {
    background: #fad17f;
    opacity:100%;
    }
    .identify{
      font-size: 14px; color:red;
    }
    
  </style>
</body>
</html>
<script>
  //====================================================================================================================================
  function orderSend(menuData,roomNm){ //음식 주문 소켓
    console.log("menuData",menuData)
    let menuorderData = [];
    let obj = new Object();
    obj.protocol = "toFrontOrder";
    obj.roomNum = roomNm;
    for(i=0;i<menuData.length;i++){
      menu = {'name':menuData[i].foodName ,'price':stringNumberToInt(menuData[i].foodPrice), 'amount':menuData[i].foodSum};
      menuorderData.push(menu);
      obj.ordermenu = menuorderData;
    }
    doSend(JSON.stringify(obj));
  }
  function UseRoom(roomData){// 방 사용,결제 소켓
    let roomOrderData = [];
    let obj = new Object();
    obj.protocol = "useRoom";
    obj.ridx = roomData[0].ridx;// idx
    obj.roomNm = roomData[0].roomNm;
    obj.people = roomData[0].people;
    obj.duration = roomData[0].duration;
    obj.price = roomData[0].price;
    room = {'ridx' : roomData[0].ridx ,'roomNm' : roomData[0].roomNm ,'people' : roomData[0].people,'duration':roomData[0].duration ,'price':stringNumberToInt(roomData[0].price)};
    roomOrderData.push(room);
    obj.orderRoom = roomOrderData;
    console.log("obj >>>>>>>>>>>> ",obj);
    doSend(JSON.stringify(obj));
  }
  function UseRoom2(ridx){// 방 사용,결제 소켓
    $.ajax({
        type : 'get' , 
        url : '/getdata?ridx='+ridx ,//room idx
      }).done(function(data){
        console.log("datata:",data.log)
        let obj = new Object();
        obj.protocol = "useRoom_reser"
        obj.idx = data.log.idx;
        obj.roomNm = data.log.roomNm;
        obj.people = data.log.people;
        obj.duration = data.log.duration;
        obj.price = data.log.fpay;
        console.log("obj >>>>>>>>>>>> ",obj);
        doSend(JSON.stringify(obj));
      }).fail(function(e){
          console.log(JSON.stringify(e));
      })
  }
  function onMessage(evt) { //받은 메세지를 보여준다      
      var obj = JSON.parse(evt.data);            
      if(obj.protocol == "roomendwait"){
       console.log("hello~~")
       reservationlisting()
      }      
      if(obj.protocol =="checkadd"){
        reservationlisting()
      }
  }
  function listRoom(){  //룸 리스팅
    console.log("hi")
      console.log("hello!")
      $.ajax({
        type : 'get' , 
        url : '/waitroom/getRoom' ,
      }).done(function(data){
        let str =''
        if(data.result == 'success'){
          for(i=0; i<data.msg.length; i++){
            str+='<div id="wait_roombox_'+data.msg[i].idx+'" class="wait_roombox " onclick ="dependOnStatus(this,'+data.msg[i].status+','+data.msg[i].idx+')" style="cursor:pointer">'
            str+='<div class="roon_numtxt _2">'+data.msg[i].roomNm+'</div>'
            str+='<div id ="status_'+data.msg[i].idx+'" class = "status"></div>'
            str+='</div>'
          }
        }else {
          // 방이 없을 때 문구 처리 
          str += '<div style = "text-align:center; width:100%;display:flex;align-items: center;">';
          str += '<div style = "width:100%;">이용가능한 방이 없습니다.</div></div>';
        }
        $(".roomscroll").html(str);
        for(i=0; i<data.msg.length; i++){
          if(data.msg[i].status == '2'){
            console.log("data.time","예약")
            $("#wait_roombox_"+data.msg[i].idx).attr('class','wait_roombox reservation ');
            $("#status_"+data.msg[i].idx).html('예약')
          }
          else if(data.msg[i].status == '0'){
            console.log("빈방")
            $("#wait_roombox_"+data.msg[i].idx).attr('class','wait_roombox empty ');
            $("#status_"+data.msg[i].idx).html('빈 방');
          } 
          else if(data.msg[i].status =='1'){
            console.log("사용중")
            $("#wait_roombox_"+data.msg[i].idx).attr('class','wait_roombox ');
            timecalculate(data.msg[i].idx)
          }
          TimeCheck(data.msg[i].idx, '30')//최소시간 30분 + 정리시간 10분 >=다음 예약 시간
        }
        }).fail(function(e){
          console.log(JSON.stringify(e));
      })
  }
  function timecalculate(idx){
    console.log("timecalculate")
    $.ajax({
        type : 'get' , 
        url : '/timeCalculate?idx='+idx ,//room idx
      }).done(function(data){
        let str ='';
        if(data.result == 'success'){
          console.log("dldldldl",savetimeformat(data.log[0].stime,data.log[0].duration).slice(0,1))
          if(savetimeformat(data.log[0].stime,data.log[0].duration,data.log[0].duration_add).slice(0,1)=='-'){
            $("#status_"+idx).html('<div><span class="timetitle">남은시간</span>0:00</div>');
          }
          else{
            $("#status_"+idx).html('<div><span class="timetitle">남은시간</span>'+savetimeformat(data.log[0].stime,data.log[0].duration,data.log[0].duration_add)+'</div>');
          }
         
        } 
      }).fail(function(e){
          console.log(JSON.stringify(e));
      })
  }
  function reservationlisting(){
    console.log("예약 체크")
    $.ajax({
    type : 'get' , 
    url : '/RoomList' , //room idx
    }).done(function(data){
        listRoom()
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  function init(){
    setInterval(minutecheck,1000)
  }
  function minutecheck() {
      let today = new Date()
      let date = new Date(today);
      let month = date.getMonth() + 1;
      let day = date.getDate();
      let hour = date.getHours();
      let minute = date.getMinutes();
      let second = date.getSeconds();
      month = month >= 10 ? month : '0' + month;
      day = day >= 10 ? day : '0' + day;
      hour = hour >= 10 ? hour : '0' + hour;
      minute = minute >= 10 ? minute : '0' + minute;
      second = second >= 10 ? second : '0' + second;

      console.log(date.getFullYear() + '-' + month + '-' + day + ' ' + hour + ':' + minute +':'+second)
      console.log(second)
      if(second == '00'){
        console.log('call reservationlisting ');
        reservationlisting();
      }
    }
    function savetimeformat(sdate,duration,duration_add) {//남은 시간 구해주는 함수
    let date = new Date(sdate);
    console.log("sdate",date,"duration",duration)
    date.setMinutes(date.getMinutes()+duration+duration_add)//date = 시작시간+사용시간 / 즉 종료시간
    let hour = date.getHours();
    let minute = date.getMinutes();

    let now = new Date();//현재시간
    let savetime = date.getTime()-now.getTime();//종료시간 - 현재시간 // timestamp값으로 나옴
    var hour2 = Math.floor((savetime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minute2 = Math.floor((savetime % (1000 * 60 * 60)) / (1000 * 60));
    if(minute2<10){
      minute2 = '0'+minute2
    }
    return hour2 + ':' + minute2;
}

  //전역변수 선언
  var vridx = 0;
  var vidx = 0;
  var total_duration=0;
  //-----------
  function dependOnStatus(self, kind, Oidx){ //방 선택시 select class 부여 기존 class 삭제 & 방 현황에 따른 팝업 연결
    console.log("kind",kind)
    $(".room_preview_imgblock").html('');
    $(".wait_roombox").removeClass('select');
    $("[id*=roomblock_]").css("display","none");
    $(self).addClass('select ');
    console.log("selfself,", $(self).children(".status").html())
      if(kind == 0 && $(self).children(".status").html()=='빈 방') {
        topRoomPop(Oidx);
      } else {
        $(".waitroom_roompop").css('display','flex')
        $(".pop").css('display','flex');
        setTimeout(function(){$(".waitroom_roompop").css('display','none');},1000);
        setTimeout(function(){$(".pop").css('display','none');},1000);
    }
  }
  function topRoomPop(Oidx){
    $.ajax({
      type : 'get' , 
      url : '/getRoomPop?idx='+Oidx , 
    }).done(function(data){
      if(data.result == 'success'){
        vridx = data.msg.roomNm;//<방 번호 전역변수에 넣어줌>
        vidx = data.msg.idx;//<방의 idx 값 전역변수에 넣어줌>
        $("#roomName").html('<span class="text-span-5" id = "roomNm">'+vridx+'번)</span> '+data.msg.name);
        $("#roomPeople").html("이용 가능 인원: 최대 "+data.msg.peopleMax+"명 (최소 인원 "+data.msg.peopleMin+"명)");
        $("#roomImg1").attr("src","/"+data.pics[0].file);
        let sql =''
        for(i=1;i<5;i++){
          if(data.pics[i] != null){
            sql+='<img src="/'+data.pics[i].file+'" loading="lazy" alt="" class="image-11" id = "roomImg'+(i+1)+'" style="float:left;">'
          }
          else{
            sql+='<img src="/" loading="lazy" alt="" class="image-11" id = "roomImg'+(i+1)+'" style="float:left; display:none;">'
          }
        }
        $(".room_preview_imgblock").append(sql);
        $("#roomblock_").css("display","flex");
      } 
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }

  function roomPop(classNm){
      closeRoomPop('noinit');
      $("#available_button").css("display","flex");
      $("#unavailable_button").css("display","none")
      $.ajax({
      type : 'get' , 
      url : '/buyRoomPop?idx='+vidx ,
    }).done(function(data){
      if(data.result == 'success'){
        console.log("ddddd",data.msg.price.toLocaleString())
        TimeCheck(vidx, '30')// 방선택하려 들어갔을 때 현재시간+10이 예약시간을 넘기는지 체크
        // 화면 상에 표시
        $("#total_duration").html(30);
        $("#total_people").html(data.msg.peopleMin);
        $("#roomPrice").html((data.msg.price+(data.msg.TPRate*3)+(data.msg.PPRate*data.msg.peopleMin)).toLocaleString())
        $("#h_Oidx").val(data.msg.idx)//방번호
        $("#roomName2").html('<span class="text-span-6" id = "roomNm2">'+vridx+'번)</span> '+data.msg.name);
        // 보이지 않는 input 칸에 임시로 보낼 값을 저장
        $("#send_people").val(data.msg.peopleMin);
        $("#send_duration").val(data.msg.peopleMin);
        $("#send_price").val(data.msg.price);
        
        $(".w-slider-slicker").filter('.slick-initialized').slick('unslick');
        $("#roomPic").html("");
        //append 사용시 방을 클릭할 때마다 요소가 추가되는 문제가 있음 -> 나갈 경우 삭제해줘야 함          
        for(var i = 0; i < data.pics.length; i++){
          $("#roomPic").append('<div class="w-slide"><img src="/" loading="lazy" style="width:100%; min-height:200px;" alt="" class="image-22" id = "subIdx_'+data.pics[i].subIdx+'"></div>');
          $("#subIdx_"+data.pics[i].subIdx).attr('src',"/"+data.pics[i].file);
        }
        $('.w-slider-slicker').slick({
          slide: 'div',		//슬라이드 되어야 할 태그 ex) div, li 
          infinite : true, 	//무한 반복 옵션	 
          slidesToShow : 1,		// 한 화면에 보여질 컨텐츠 개수
          slidesToScroll : 1,		//스크롤 한번에 움직일 컨텐츠 개수
          // speed : 200,	 // 다음 버튼 누르고 다음 화면 뜨는데까지 걸리는 시간(ms)
          arrows : true, 		// 옆으로 이동하는 화살표 표시 여부
          dots : true, 		// 스크롤바 아래 점으로 페이지네이션 여부
          autoplay : true,			// 자동 스크롤 사용 여부
          autoplaySpeed : 1000, 		// 자동 스크롤 시 다음으로 넘어가는데 걸리는 시간 (ms)
          pauseOnHover : true,		// 슬라이드 이동	시 마우스 호버하면 슬라이더 멈추게 설정buyPop
          vertical : false,		// 세로 방향 슬라이드 옵션
          prevArrow : '<div class="w-slider-arrow-left"><div class="w-icon-slider-left"></div></div>',  // 이전 화살표 모양 설정
          nextArrow : '<div class="w-slider-arrow-right"><div class="w-icon-slider-right"></div></div>',  // 다음 화살표 모양 설정
          // dotsClass : "w-slider-nav", 	//아래 나오는 페이지네이션(점) css class 지정 
          draggable : true, 	//드래그 가능 여부
        });        
        $(".slick-dots").css("padding","0px");

        $(".buypop_previewblock").html('');
        let sql =''
        for(i=1;i<5;i++){
          if(data.pics[i] != null){
            sql+='<a href="#" class="link-block-12 w-inline-block"><img src="/'+data.pics[i].file+'" loading="lazy" alt="" class="image-13" id = "roomImg3_'+(i+1)+'" style="width:158px; height:100px;"></a>'
          }
          else{
            sql+=''
          }
        }
        $(".buypop_previewblock").append(sql);
        $("."+classNm).css('display','flex')
        $(".buypop").css('display','flex')
        $(".pop").css('display','flex');
        
        // 사진 오류
      } else if (data.result == 'fail'){

      } 
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  function plusOrMinus(type, status){
    let Oidx = $("#h_Oidx").val()
    $.ajax({
      type : 'get' , 
      url : '/getRoomPop?idx='+Oidx ,
    }).done(function(data){
      if(data.result == 'success'){
        var dv = Number($("#total_"+type).html());
        var cp = stringNumberToInt($("#roomPrice").html());
        console.log("he",dv,cp)
        const TPRate = data.msg.TPRate
        const PPRate =data.msg.PPRate;
        if (status == 0 && dv > 30 && type == "duration") {
          var tv = dv - 10;
          var cp = cp - TPRate;
        } else if (status == 0 && dv > data.msg.peopleMin && type == "people"){
            var tv = dv - 1;
            var cp = cp - PPRate;
        } else if (status == 1 && dv < 300 && type == "duration"){
            var tv = dv + 10;
            var cp = cp + TPRate;
        } else if (status == 1 && dv < data.msg.peopleMax && type == "people"){
            var tv = dv + 1;
            var cp = cp + PPRate;
        } else {
          var tv = dv;
          var cp = cp;
        }
      $("#total_"+type).html(tv);
      $("#roomPrice").html(cp.toLocaleString());
      $("#roomPrice2").html(cp);
      $("#send_"+type).val(tv);
      $("#send_price").val(cp);
      // let rrate = data.set[0].rrate / 100 //새로 산출된 총 금액에 적립률 곱하기
      // $("#accumulate_amount").html(cp * rrate)
      TimeCheck(vidx,  $("#total_"+type).html())
      total_duration=$("#total_duration").html()
      console.log("total_duration",total_duration)
    } else if (data.result == 'fail'){
    } 
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  function TimeCheck(idx, time){
    console.log("idx,time",idx,time)
    $.ajax({
      type : 'get' , 
      url : '/TimeCheck?idx='+idx+'&time='+time , 
    }).done(function(data){
      if(data.result == 'success'){
        console.log("성공!!!!!")
        $("#available_button").css("display","flex");
        $("#unavailable_button").css("display","none")
        $("#available_calbutton").css("display","flex");
        $("#unavailable_calbutton").css("display","none")
      }
      else{
        console.log("?")
        if(time=='30'){
          $("#wait_roombox_"+idx).attr('class','wait_roombox reservation ');
         $("#status_"+idx).html('예약')
        }
        console.log("이미 있음")
        // $("#total_duration").html(time-10);
        $("#available_button").css("display","none");
        $("#unavailable_button").css("display","flex")
        $("#available_calbutton").css("display","none");
        $("#unavailable_calbutton").css("display","flex")
      }
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  $(".foodpop_togglebtn").click(function () {
     $(this).next(".foodpop_toggle").slideToggle(200);
     $(this).children('img').toggleClass('open')
  });
  function clickroom(){
      reservationlisting();
      $("#people_option option").prop("selected", false);// 옵션 설정 초기화
      $("#homebody").css("display","none")
      $("#roombody").css("display","flex")
  }
  function returnpop(){
    $("#roombody").css("display","none")
    $("#homebody").css("display","flex")
  }
  function closePop(){
    $(".wait_buyroomblock").css("display","none");
    $(".room_preview_imgblock").html('');
  }
  function closeRoomPop(close){
    console.log("closeroompop")
    //if(popupMsg("창을 닫으면 모든 데이터가 삭제됩니다\n그래도 닫으시겠습니까?")){
    ridx=0;
    idx=0;
    if(close =='orderfail'){
      $("#orderfail").css('display','none')
    }
    else{
      $("#total1").css('display','none')
      $("#total2").css('display','none')
      $("#foodpop1").css('display','none')
      $("#foodpop2").css('display','none')
      $(".reserveinput_pop").css('display','none')
      $(".reserveselect_pop").css('display','none')
      $(".reservecheck_pop").css('display','none')
      $(".waitroom_roompop").css('display','none')
      $(".totalpayment_pop2").css('display','none');
      $(".kiosk_popbox._pop2").css('display','none');
      $(".kioskpop").css('display','none')
      $(".totalpayment_box").css('display','none');
      $(".buypop_box").css('display','none');
      $(".buypop").css('display','none')
      $(".pop").css('display','none');
      $("#reserver_number").val(''); // 전화번호 입력창 초기화 
      $("#point_number").val(''); // 전화번호 입력창 초기화 
      input_num ='';
    }
    if(close == "noinit" ){
      menuBodyInit()
    }
    else{
      $("#total_duration").html(30)
      $("#total_people").html(1)// 창을 닫을 경우 기존의 인원수/방 수 초기화
      foodBodyInit()
    }
  }
  function closeRoomInfoPop(){
    //if(popupMsg("창을 닫으면 모든 데이터가 삭제됩니다\n그래도 닫으시겠습니까?")){
    $("#total1").css('display','none')
    $("#total2").css('display','none')
    $("#foodpop1").css('display','none')
    $("#foodpop2").css('display','none')
    $(".reserveinput_pop").css('display','none')
    $(".reserveselect_pop").css('display','none')
    $(".reservecheck_pop").css('display','none')
    $(".waitroom_roompop").css('display','none')
    $(".totalpayment_pop2").css('display','none');
    $(".kiosk_popbox._pop2").css('display','none');
    $(".kioskpop").css('display','none')
    $(".totalpayment_box").css('display','none');
    $(".buypop_box").css('display','none');
    $(".buypop").css('display','none')
    $(".pop").css('display','none');
    $("#total_duration").html(30)
    $("#total_people").html(1) // 창을 닫을 경우 기존의 인원수/방 수 초기화
    $("[id*=roomprice_]").html(0)
  }
  function popupMsg(msg){
    $(".waitroom_popbox").text(msg);
    $(".waitroom_roompop").css('display','flex');
    setTimeout(function(){$(".waitroom_roompop").css('display','none');},700);
  }

  function kioskroommenu(num){//방 선택 후 결제하는 함수
    console.log("totaldurationlast",total_duration)
    $.ajax({
      type : 'get' , 
      url : '/TimeCheck?idx='+vidx+'&time='+total_duration , 
    }).done(function(data){
      if(data.result == 'success'){
        console.log("성공")
        kioskroomsuccess(num)
      }
      else{
        console.log("이미예약")
        popupMsg('이미 예약된 방입니다.')
        $("#available_calbutton").css("display","none");
        $("#unavailable_calbutton").css("display","flex")
      }
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  function kioskroomsuccess(num){
    closeRoomPop('noinit');
    let checkmoney = $("#food_price"+num).html()
    console.log("checkmoney",checkmoney)
    if(checkmoney == '0'){// 음식 추가 안했을 때
      RoomInfoSend();//방 결제
      console.log("방만")
    }
    else{//음식 추가 했을 때
      console.log("음식/방 둘 다")
      RoomInfoSend()
      kioskorder(num);
    }
    $(".kioskpop").css('display','flex')
    $(".pop").css('display','flex');
  }

  function kioskmenu(num){//예약자 음식 주문 함수
    closeRoomPop();
    ReserUseRoom()
    kioskorder(num);
  }

  function kioskorder(num){//음식 주문 실행 함수
    console.log("num",num)
    let orderlength = $("#foodtotal"+num).find(".totalpayment_txt").length;
    console.log("!",orderlength)
    let menuData = [];
    var roomNm = vridx
    for(i=0;i<orderlength;i++){//등록할 메뉴 담기 
        id=$('#foodtotal'+num).find('.totalpayment_txt:eq('+i+')').attr('id')//메뉴 id
        console.log("id",id)
        console.log("foodsum,", $("#"+id).find('#foodamount'+num).html())
        foodname = $("#foodtotal"+num).find("#"+id).html().split('<')[0] //메뉴 이름
        foodsum = $("#"+id).find('#foodamount'+num).html().split('개')[0];//메뉴수량
        foodprice = $("#"+id).find('#price_menu'+num).html().split(')')[0];//메뉴가격
        let data = {'kind' : 1,'ridx' : vidx ,'midx' : id.split('_')[1],'foodName':foodname ,'foodPrice':foodprice, 'foodSum':foodsum};
        menuData.push(data);
      }      
      console.log("menudata,",menuData)
      console.log("여기까지는?")
    $.ajax({
    type : 'post' , 
    url : '/orderMenu_waitroom' , 
    data : JSON.stringify(menuData),
    dataType : 'json' ,
    }).done(function(data){  
      if(data.result == 'success'){
        console.log("성공성공")
        orderSend(menuData,roomNm);
      }
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }

  function RoomInfoSend(){//결제 시 방 현황 및 정보 전송
    let roomData = [];
    let roomTime = $("#total_duration").html()
    let roomPeople = $("#total_people").html()
    people = roomPeople;
    duration = roomTime;
    price = $("#roomPrice").html()
    let data = {'ridx' : vidx,'roomNm' : vridx ,'people' : people,'duration':duration ,'price':price};
    roomData.push(data);
    console.log("roomData",roomData)
    $.ajax({
      type : 'post' , 
      url : '/orderRoom_waitroom' , 
      data : JSON.stringify(roomData),
      dataType : 'json' ,
    }).done(function(data){  
      if(data.result == 'success'){
        console.log("vidx",vidx)
        UseRoom(roomData);
        reservationlisting()
      }
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })
  }
  function pointpop(){
    closeRoomPop()
    $(".totalpayment_pop2").css('display','flex')
    $(".pop").css('display','flex');
  }
  
  function reservecheck(cl){
    number=0;
    closeRoomPop();
    $("."+cl).css('display','flex');
    $(".reservecheck_pop").css('display','flex');
    $(".pop").css('display','flex');
  }
  function food1(){
    closeRoomPop('noinit')
    let roomTime = $("#total_duration").html()
    let roomPeople = $("#total_people").html()
    $("#foodpop1").css('display','flex');
    $(".buypop").css('display','flex')
    $(".pop").css('display','flex');
    var cp = +$("#roomPrice").html(); // 추가 선택 없이 방 선택시 총액을 다음 팝업에도 적용
    $("#roomPrice2").html(cp);
  }
  function food2(){
    if(vridx == '0'){
      commonpay('예약을 선택해주세요','reserveselect_pop')
    }
    else{
      console.log("vridx",vridx)
      closeRoomPop('noinit')
      $("#foodpop2").css('display','flex');
      $(".buypop").css('display','flex')
      $(".pop").css('display','flex');  
    }
  }
  function total1(num,noadd){ //추후 수정 필요
    total2(num,noadd);
    //방 계산 기능
    let roomTime = $("#total_duration").html()
    let roomPeople = $("#total_people").html()
    $("#roomTime_all").html(roomTime+"분")
    $("#roomPrice_all").html(roomPeople+"명("+$("#roomPrice").html()+")")
    $("#precisePrice"+num).html($("#roomPrice").html().toLocaleString()+"원")
    $("#point_RoomPrice").html($("#roomPrice").html().toLocaleString()+"원")
    $("#point_TotalPrice").html($("#total_price"+num).html())
  }
  function total2(num,noadd){ // 총 결제액 계산해주는 함수
    console.log("num",num)
    if(noadd == 'noadd'){//추가 안함을 눌렀을 때(방선택 후 음식선택에서)
      $('[id^="foodtotal"]').html('')
      closeRoomPop('noinit')
      $('[id^="food_price"]').html('0')
      $("#point_FoodPrice").html('0')
      $("#total"+num).css('display','flex');
      $(".buypop").css('display','flex');
      $(".pop").css('display','flex');
    }
    else{//담기를 눌렀을 때
      $('[id^="foodtotal"]').html('')
      let orderlength=$('#foodselect_area_'+num).find('.foodselect_box').length;
      if(orderlength == 0){//음식이 안담겼을 때
        $("#orderfail").css('display','flex');
        $(".pop").css('display','flex');
      }
      else{//음식이 담겨있을 때
        closeRoomPop('noinit')//초기화 되지않도록 noinit 보내줌
        let sum=0
        let str=''
        $("#food_price"+num).html($("#foodPrice"+num).html())
        $("#point_FoodPrice").html($("#foodPrice"+num).html())
        for(i=0;i<orderlength;i++){
          id=$('#foodselect_area_'+num).find('.foodselect_box:eq('+i+')').attr('id')
          foodNm = $("#"+id).find("div:eq(0)").html();//메뉴이름
          foodPrice = $("#"+id).find("div:eq(1)").html();//메뉴가격
          foodAmount = $("#"+id).find(".food_quantity").html();//메뉴수량
          str+='<div class="totalpayment_txt" id="'+id+'_total">'+foodNm+'<span id="foodamount'+num+'">'+foodAmount+'개 (<span id="price_menu'+num+'">'+(foodPrice*foodAmount).toLocaleString()+')</span></span></div>'
        }
        $("#foodtotal"+num).prepend(str)//주문목록에 담기
        $(".buypop").css('display','flex')
        $(".pop").css('display','flex'); 
        $("#total"+num).css('display','flex');
      }
    }
    if(num=='1'){//방 선택 후 음식 선택이라면
      let allprice = stringNumberToInt($("#roomPrice").html()) +stringNumberToInt($("#food_price1").html().split('원')[0])
      $("#total_price"+num).html(allprice.toLocaleString()+"원")
    }
    else{//예약자 음식 선택이라면
      $("#total_price"+num).html($("#foodPrice"+num).html())
      $("#total"+num).css('display','flex');
    }
    totalPoint(stringNumberToInt($("#roomPrice").html()))
  }
  
  function commonpay(con,name=''){ // 적립 완료 혹은 적립 취소 시에 결제 완료 팝업 + 결제 데이터 전송
    closeRoomPop()
    $(".commonpopbox").html(con)
    $(".commonpop").css('display','flex');
    $(".pop").css('display','flex');
    if(name == 'reserveinput_pop'|| name=='reserveselect_pop'){
      $("."+name).css('display','flex');
      $(".reservecheck_pop").css('display','flex');
      setTimeout(function(){$(".commonpop").css('display','none');},1000);
      $(".pop").css('display','flex');
    }
    else if(name == 'totalpayment_pop2'){
      $("."+name).css('display','flex');
      setTimeout(function(){$(".commonpop").css('display','none');},1000);
      $(".pop").css('display','flex');
    }
    else{
      setTimeout(function(){$(".commonpop").css('display','none');},1000);
      setTimeout(function(){$(".pop").css('display','none');},1000);
      setTimeout(function(){$(".wait_buyroomblock").css('display','none');},1000);
    }
  }
//-------------------------------------------------------------------------음식 주문
function clickFood(self,category,num){//카테고리별 메뉴 리스팅
    $.ajax({
      type : 'get' , 
      url : '/getlistFood_wait?category='+category ,
    }).done(function(data){
      console.log(data);
      console.log("cate",category)
      let str =''
      for(i=0; i<data.msg.length; i++){
        if(data.msg[i].sell == 0){
          str+='<a id="menulist_'+data.msg[i].idx+'" class="link-block-24 w-inline-block"><img src="/'+data.msg[i].pic+'" width="220px" height="160px" loading="lazy" alt="" class="foodpop_img">'
          str+='<div class="foodselect_info">'+data.msg[i].name+'<span class="soldout">품절</span></div>'
        }
        else if(data.msg[i].sell == 1){
          str+='<a href="javascript:foodsave(\'menulist_'+data.msg[i].idx+'\',\''+num+'\')" id="menulist_'+data.msg[i].idx+'" class="link-block-24 w-inline-block"><img src="/'+data.msg[i].pic+'" width="220px" height="160px" loading="lazy" alt="" class="foodpop_img">'
          str+='<div class="foodselect_info">'+data.msg[i].name+'<span class="food_price">'+data.msg[i].price+'원</span></div>'
        }
        str+='</a>'
        if(category == 'Food'){
          $("#Foodbox"+num).html(str);
          console.log($("#Foodbox").html())
        }else if(category == 'Cafe'){
          $("#Cafebox"+num).html(str);
        }else{
          $("#Pubbox"+num).html(str);
        }
      }
    
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })           
  }
  function foodsave(id,num){// 담기 버튼 누르면 실행    
    let foodNm = $("#"+id).find(".foodselect_info").html().split('<')[0];//메뉴이름
    let foodPrice = Number($("#"+id).find(".food_price").html().split('원')[0]);//메뉴가격
    let foodQuantity = $("#order_"+id.split('_')[1]).find(".food_quantity");//담을 때 같은 메뉴가 있는지 확인하기 위해
    if(foodQuantity.length > 0){
      let foodsum = Number(foodQuantity.html());
      foodQuantity.html(foodsum+1);
      pricesum(num);
    }else{
      let str =''
      str+='<div class="foodselect_box" id="order_'+id.split('_')[1]+'">'
      str+='<div class="food_selecttxt">'+foodNm+'</div>'
      str+='<div class="food_selecttxt">'+foodPrice+'</div>'
      str+='<div class="quantity_box2">'
      str+='<a href="#" class="p_m_btn _2 w-button" onclick="minusfood(this,\''+num+'\')">-</a>'
      str+='<div class="food_quantity">1</div>'
      str+='<a href="#" class="p_m_btn w-button" onclick="addfood(this,\''+num+'\')">+</a>'
      str+='</div>'
      str+='<div class="cancle_box2">'
      str+='<a href="#" onclick="closeorder(this,\''+num+'\')" class="link-block-4 w-inline-block"><img src="../user/images/close_icon.svg" loading="lazy" alt="" class="image-6"></a>'
      str+='</div>'
      str+=' </div>'
      $("#foodselect_area_"+num).append(str) 
      let foodsum = Number($("#"+foodNm).html());
      //총 주문금액 계산 함수 호출
      pricesum(num)
    }          
  }
  function closeorder(self,num){//주문목록 상품 삭제
    $(self).parents(".foodselect_box").remove();
    //$("#"+name+'1').remove();
    pricesum(num)

  }
  function addfood(self,num){//수량 +
    console.log($(self).parent().find('div').html())
    sum= $(self).parent().find('div').html()
    sum++
    $(self).parent().find('div').html(sum)
    pricesum(num)
  }
  function minusfood(self,num){//수량 -
    console.log( $(self).parent().find('div').html())
    minus= $(self).parent().find('div').html()
    if(minus>1){
      minus--
    }
    $(self).parent().find('div').html(minus)
    pricesum(num)
  }
  function pricesum(num){//주문목록에 있는 모든 상품들을 계산해주는 함수
    orderlength=$('#foodselect_area_'+num).find('.foodselect_box').length
    console.log("orderlength",orderlength)
    sum=0
    if(orderlength==0){
      $("#foodPrice"+num).html("0원")
    }
    for(i=0;i<orderlength;i++){
      id=$('#foodselect_area_'+num).find('.foodselect_box:eq('+i+')').attr('id')
      foodNm = $("#"+id).find("div:eq(1)").html();//메뉴가격
      console.log("foodNm,",foodNm)
      foodsum = $("#"+id).find(".food_quantity").html();//메뉴수량
      console.log("foodsum,",foodsum)
      sum+=(foodNm*foodsum)
      $("#foodPrice"+num).html(sum.toLocaleString()+"원")
    }
  }
  function foodBodyInit(){
    console.log("foodbodyinit")
    $(".foodselect_area").html('')
    $(".foodpop_toggle").css('display','none');
    $('[id^="food_price"]').html('0')
    $('[id^="total_price"]').html('0원')
    $('[id^="foodPrice"]').html('0원')
  }
  function menuBodyInit(){
    console.log("menubodyinit")
  }
  var datalist = 0;
  var reservelistnum= 0;
  var phonenumber=0;
  //예약자 확인 - 전화번호 입력
  let input_num =''
  function phoneNum(num){
    if (num == '-1' && $("#reserver_number").val().length > 0){
      console.log("ddddd",$("#reserver_number").val())
      input_num = $("#reserver_number").val().slice(0, -1);
    } else if (num != '-1' && $("#reserver_number").val().length < 11) {
      input_num += num;
    }
    $("#reserver_number").val(input_num);
    phonenumber =  $("#reserver_number").val();
  }
  //포인트 적립 - 전화번호 입력
  function pointNum(num){
    if (num == '-1' && $("#point_number").val().length > 0){//지움 눌렀을 때
      input_num = $("#point_number").val().slice(0, -1);
    } else if (num != '-1' && $("#point_number").val().length < 11) {
      input_num += num;
    }
    $("#point_number").val(input_num);
    phonenumber = $("#point_number").val();
  }
  function phoneReserveCheck(){
    $("#reser_list").html('')
    $.ajax({
      type : 'get' , 
      url : '/getReservationByNum?number='+phonenumber ,
    }).done(function(data){
      let str =''
      if(data.result == 'success'){
        reservecheck('reserveselect_pop');
        for(i=0; i<data.msg.length; i++){
          str += '<a href="#" class="link-block-26 w-inline-block" id = "selectList_'+data.msg[i].idx+'" onclick="selectReserve(this,'+data.msg[i].roomNm+','+data.msg[i].idx+')">'//idx는 roomreservation idx
          str += '<div class="reserve_title">'+data.msg[i].name.slice(0,1)+'** 님 ('+data.msg[i].number.slice(0,3)+'-****-'+data.msg[i].number.slice(-4)+')</div>'
          str += '<div class="reserve_subtitle" id="'+[i+1]+'">예약 정보</div>'
          str += '<div>예약 일시: '+dateTimeFormat(data.msg[i].stime)+'<br>방 번호: <span id="reserveroomNm">'+data.msg[i].roomNm+'번 방</span><br>인원: '+data.msg[i].people+'인</div>'
          str += '</a>'
        }
        $("#reser_list").append(str);
        datalist = data.msg
        console.log("daTalist",datalist)
      } else {
        commonpay("연락처와 일치하는 예약내역이 없습니다.",'reserveinput_pop')
      }            
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })           
  }
  let point_save = 0;
  function totalPoint(price){
    console.log("price",price)
    $.ajax({
      type : 'get' , 
      url : '/getPointPercent?' ,
    }).done(function(data){
      console.log("percent",data.percent[0].rrate);
      let point = price*data.percent[0].rrate/100
      $("#total_point1").html(point.toLocaleString()+'pt')
      $("#all_point").html(point.toLocaleString()+'pt')
      point_save = point
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })           
  }
  function savePoint(){
    console.log("number예약!!,",phonenumber)
    $.ajax({
      type : 'get' , 
      url : '/getsavePoint?number='+phonenumber+'&point='+point_save ,
    }).done(function(data){
      if(data.result == 'success'){
        commonpay("결제 및 적립이 완료되었습니다.")
      } else {
        commonpay(data.msg,'totalpayment_pop2')
      }            
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })           
  }
  var roomreseridx=0;
  function selectReserve(self,roomNm,idx){ //예약 리스트 선택시 select 클래스 부여
    $("[id*=selectList_]").removeClass('select');
    $(self).addClass('select');
    number = $(self).find(".reserve_subtitle").attr('id')
    console.log("number",number)
    // vidx = $(self).find(".reserve_subtitle").attr('id')
    vridx = roomNm;
    roomreseridx = idx;
    console.log("vridx",vridx)
    console.log("roomreseridx:",roomreseridx)
  }
  function optionselect(){
    let data = $("#option-form").serialize();
    console.log("searchForm:: ",data)
    $.ajax({
      type : 'post' , 
      url : '/optionselect' , 
      data : data,
      dataType : 'json' ,
    }).done(function(data){  
      let str =''
      if(data.result == 'success'){
          for(i=0; i<data.info.length; i++){
            str+='<div id="wait_roombox_'+data.info[i].idx+'" class="wait_roombox " onclick ="dependOnStatus(this,'+data.info[i].status+','+data.info[i].idx+')" style="cursor:pointer">'
            str+='<div class="roon_numtxt _2">'+data.info[i].roomNm+'</div>'
            str+='<div id ="status_'+data.info[i].idx+'" class = "status"></div>'
            str+='</div>'
          }
      }else {
        // 방이 없을 때 문구 처리 
        str += '<div style = "text-align:center; width:550px; height: 600px; display:flex;align-items: center;">';
        str += '<div style = "width:650px; color:gray;">이용가능한 방이 없습니다.</div></div>';
      }
      $(".roomscroll").html(str);
      for(i=0; i<data.info.length; i++){
        if(data.info[i].status == '2'){
          console.log("data.time","예약")
          $("#wait_roombox_"+data.info[i].idx).attr('class','wait_roombox reservation ');
          $("#status_"+data.info[i].idx).html('예약')
        }
        else if(data.info[i].status == '0'){
          $("#wait_roombox_"+data.info[i].idx).attr('class','wait_roombox empty ');
          $("#status_"+data.info[i].idx).html('빈 방');
        } 
        else if(data.info[i].status =='1'){
          $("#wait_roombox_"+data.info[i].idx).attr('class','wait_roombox ');
          timecalculate(data.info[i].idx)
        }
      }
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })         
  }
  function ReserUseRoom(){ //예약자 방 사용하기
    console.log("vridx",vridx)
    console.log("roomreseridx",roomreseridx)//roomreservation idx?
    console.log("datalist:",datalist)
    console.log("dataaa",datalist[number-1])
    $.ajax({
      type : 'post' , 
      url : '/reseruseroom' , 
      data : datalist[number-1],
      dataType : 'json' ,
    }).done(function(data){  
      commonpay('방으로 입장해주세요.')
      reservationlisting()
      UseRoom2(data.ridx);
    }).fail(function(e){
      console.log(JSON.stringify(e));
    })          
  }
  //공통함수
  function stringNumberToInt(stringNumber){// 숫자 ,로 변환된 문자열을 계산 전에 정수형으로 바꿔줌
    return parseInt(stringNumber.replace(/,/g , ''));
  }
  function dateTimeFormat(sdate) {
    let date = new Date(sdate);
    let month = date.getMonth() + 1;
    let day = date.getDate();
    let hour = date.getHours();
    let minute = date.getMinutes();
    let second = date.getSeconds();

    month = month >= 10 ? month : '0' + month;
    day = day >= 10 ? day : '0' + day;
    hour = hour >= 10 ? hour : '0' + hour;
    minute = minute >= 10 ? minute : '0' + minute;
    second = second >= 10 ? second : '0' + second;

    return date.getFullYear() + '/' + month + '/' + day + ' | ' + hour + ':' + minute 
}
init();
</script>